{"id":"chatbot-05x","title":"Implement DOCX generation with docxtemplater","description":"Create DOCX generation service using docxtemplater for editable documents","design":"Create backend/src/services/document/docx.service.ts. Use docxtemplater + PizZip. Load .docx template, replace {{variables}}, generate output buffer. Support Vietnamese text. Add draft watermark in header.","acceptance_criteria":"DOCX generated from template, variables replaced, document opens in Word/LibreOffice correctly, Vietnamese displays","status":"closed","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:26:53.6764433+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:26:39.7339912+07:00","closed_at":"2026-02-05T14:26:39.7339912+07:00","close_reason":"DOCX generation with docxtemplater implemented at backend/src/services/document/docx.service.ts. Features: variable formatting, number-to-words, draft indicators.","labels":["component:backend","phase:us5","spec:001-planning","story:US5"],"dependencies":[{"issue_id":"chatbot-05x","depends_on_id":"chatbot-1qr","type":"parent-child","created_at":"2026-02-04T16:26:53.6819083+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-0d2","title":"Create Conversation API endpoints","description":"Implement REST endpoints for conversation management per openapi.yaml","design":"Create backend/src/api/routes/conversations.ts. Endpoints: GET /conversations (list), POST /conversations (create), GET /conversations/:id (get with messages), PATCH /conversations/:id (update), DELETE /conversations/:id. Add Zod validation, auth middleware.","acceptance_criteria":"All endpoints return correct status codes, validation errors handled, auth enforced, responses match openapi.yaml schemas","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:23:39.8355335+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:04:58.6106231+07:00","closed_at":"2026-02-05T14:04:58.6106231+07:00","close_reason":"Conversation API endpoints updated to use ConversationService. All CRUD operations: list (paginated), create, get (with messages), update, delete (soft). User ownership verification, status filtering, proper DTO mapping.","labels":["component:backend","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-0d2","depends_on_id":"chatbot-fga","type":"parent-child","created_at":"2026-02-04T16:23:39.8411601+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-0d2","depends_on_id":"chatbot-4yw","type":"blocks","created_at":"2026-02-04T16:23:39.8459531+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-0eb","title":"Configure linting and formatting","description":"Set up ESLint + Prettier for TypeScript projects and Black + isort for Python","design":"Backend/Frontend: Install eslint, prettier, @typescript-eslint/*. Create .eslintrc.js, .prettierrc. Crawler: Install black, isort, mypy. Create pyproject.toml with tool configs. Add pre-commit hooks.","acceptance_criteria":"npm run lint passes on both TS projects, black --check passes on crawler, all formatters configured","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:22:19.6962146+07:00","created_by":"Bao Lam","updated_at":"2026-02-04T17:30:44.3957969+07:00","closed_at":"2026-02-04T17:30:44.3957969+07:00","close_reason":"ESLint + Prettier configured for backend/frontend. Backend uses flat config (eslint.config.js). Frontend uses Next.js built-in ESLint. Black + Ruff configured in crawler pyproject.toml. npm run lint passes on both TS projects.","labels":["component:infra","phase:setup","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-0eb","depends_on_id":"chatbot-5i0","type":"parent-child","created_at":"2026-02-04T16:22:19.700119+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-0eb","depends_on_id":"chatbot-25w","type":"blocks","created_at":"2026-02-04T16:22:19.703831+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-0eb","depends_on_id":"chatbot-15l","type":"blocks","created_at":"2026-02-04T16:22:19.708134+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-0eb","depends_on_id":"chatbot-18y","type":"blocks","created_at":"2026-02-04T16:22:19.7107883+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-0ot","title":"Add Langfuse for LLM observability","description":"Integrate Langfuse for tracking LLM token usage, costs, and latency","design":"Install langfuse SDK. Wrap Claude API calls to track: input/output tokens, model, latency, cost estimate. Add user context for per-user cost aggregation. Configure Langfuse dashboard.","acceptance_criteria":"LLM calls tracked in Langfuse, token usage visible, cost estimates calculated, latency histograms available","status":"closed","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:27:57.3808069+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:29:09.2654212+07:00","closed_at":"2026-02-05T14:29:09.2654212+07:00","close_reason":"Langfuse LLM observability integrated at backend/src/lib/langfuse.ts. Provides trace/generation tracking with token usage and latency metrics.","labels":["component:observability","phase:polish","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-0ot","depends_on_id":"chatbot-rts","type":"parent-child","created_at":"2026-02-04T16:27:57.384493+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-0ot","depends_on_id":"chatbot-bnf","type":"blocks","created_at":"2026-02-04T16:27:57.3954408+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-0re","title":"Create PostgreSQL indexer for documents and chunks","description":"Store legal documents and chunks with embeddings in PostgreSQL using pgvector","design":"Create crawler/src/indexers/db_indexer.py. Insert LegalDocument records, then DocumentChunk records with embeddings. Use psycopg2 with pgvector support. Create IVFFlat index (lists=300) for similarity search. Implement upsert for incremental updates.","acceptance_criteria":"Documents and chunks stored correctly, vector index created, similarity search query works, upsert handles updates","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:25:00.9956286+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:12:01.7084241+07:00","closed_at":"2026-02-05T14:12:01.7084241+07:00","close_reason":"PostgreSQL indexer implemented with pgvector. Features: index_document (upsert with embeddings), search_similar (vector similarity), get_document_count, get_chunk_count.","labels":["component:crawler","component:db","phase:us2","spec:001-planning","story:US2"],"dependencies":[{"issue_id":"chatbot-0re","depends_on_id":"chatbot-206","type":"parent-child","created_at":"2026-02-04T16:25:01.0020259+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-0re","depends_on_id":"chatbot-nl9","type":"blocks","created_at":"2026-02-04T16:25:01.0098214+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-15l","title":"Initialize frontend Next.js project","description":"Initialize Next.js 14+ project in frontend/ with React 18, TypeScript, and Tailwind CSS","design":"Run npx create-next-app@latest in frontend/ with TypeScript, Tailwind, App Router. Install additional: @tanstack/react-query for API client. Configure next.config.js for API proxy to backend.","acceptance_criteria":"npm run dev starts Next.js on port 3001, pages render correctly, Tailwind styles work","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:22:04.1762359+07:00","created_by":"Bao Lam","updated_at":"2026-02-04T17:23:19.83076+07:00","closed_at":"2026-02-04T17:23:19.83076+07:00","close_reason":"Frontend Next.js 16 project initialized with React 19, TypeScript, Tailwind CSS, App Router, React Query. Runs on port 3001. API proxy configured to backend.","labels":["component:frontend","phase:setup","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-15l","depends_on_id":"chatbot-5i0","type":"parent-child","created_at":"2026-02-04T16:22:04.1821792+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-15l","depends_on_id":"chatbot-95j","type":"blocks","created_at":"2026-02-04T16:22:04.1878209+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-17y","title":"Phase 5: US3 - Legal Chat Agent","description":"User Story 3: As a user, I want to ask legal questions and receive accurate answers with citations so that I can understand Vietnamese law. Goal: RAG-based Q\u0026A with Groq LLM. Test: python -m legal_chatbot chat 'Dieu kien thue nha' returns relevant answer with citations.","status":"open","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:19:44.8610782+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:19:44.8610782+07:00","labels":["component:chat","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-17y","depends_on_id":"chatbot-bzv","type":"parent-child","created_at":"2026-02-05T15:19:44.8647782+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-17y","depends_on_id":"chatbot-hy0","type":"blocks","created_at":"2026-02-05T15:22:41.8744163+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-18p","title":"Implement rate limiting and security headers","description":"Add rate limiting, CORS configuration, and security headers","design":"Install express-rate-limit, helmet. Configure: 100 req/min per user for chat, 10 req/min for document generation. Add helmet security headers. Configure CORS for frontend origin only in production.","acceptance_criteria":"Rate limits enforced, 429 returned when exceeded, security headers present, CORS blocks unauthorized origins","status":"closed","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:28:06.1707095+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:29:06.7506721+07:00","closed_at":"2026-02-05T14:29:06.7506721+07:00","close_reason":"Rate limiting and security headers implemented at backend/src/api/middleware/security.ts. Includes: rate limiter with memory store, security headers (CSP, HSTS, etc.), CORS configuration.","labels":["component:backend","component:security","phase:polish","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-18p","depends_on_id":"chatbot-rts","type":"parent-child","created_at":"2026-02-04T16:28:06.1784344+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-18y","title":"Initialize crawler Python project","description":"Initialize Python 3.11+ project in crawler/ with Playwright, pdfplumber, and CLI tools","design":"Create pyproject.toml or requirements.txt. Install: playwright, pdfplumber, psycopg2-binary, sentence-transformers, click (CLI). Add pytest for testing. Create virtual environment setup in crawler/.venv","acceptance_criteria":"python -m crawler.cli --help shows available commands, playwright install succeeds, pytest runs","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:22:11.4097116+07:00","created_by":"Bao Lam","updated_at":"2026-02-04T17:24:16.3341757+07:00","closed_at":"2026-02-04T17:24:16.3341757+07:00","close_reason":"Python 3.11+ project initialized with pyproject.toml and requirements.txt. Includes: playwright, pdfplumber, sentence-transformers, click CLI. Package structure: src/{scrapers,parsers,indexers,cli}. CLI commands: crawl, index, check-updates implemented.","labels":["component:crawler","phase:setup","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-18y","depends_on_id":"chatbot-5i0","type":"parent-child","created_at":"2026-02-04T16:22:11.4134288+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-18y","depends_on_id":"chatbot-95j","type":"blocks","created_at":"2026-02-04T16:22:11.4171345+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-1b7","title":"Create Vietnamese text utilities","description":"Create utilities for Vietnamese text processing.","design":"Create legal_chatbot/utils/vietnamese.py with: normalize_vietnamese() for NFD normalization, extract_article_number() to parse Dieu patterns, clean_legal_text() to remove HTML artifacts and normalize whitespace.","acceptance_criteria":"Vietnamese text normalized consistently. Article numbers extracted correctly from 'Dieu 1', 'Điều 123' patterns.","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:17:48.0340236+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:17:48.0340236+07:00","labels":["component:utils","phase:foundational","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-1b7","depends_on_id":"chatbot-t2s","type":"parent-child","created_at":"2026-02-05T15:17:48.0396227+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-1bv","title":"Add generate CLI command","description":"Implement CLI command for generating PDF contracts.","design":"In cli/generate.py add: generate command with --template, --output, --data (JSON string), --interactive flags. In interactive mode, prompt for each required field. Validate before generating. Show success message with output path.","acceptance_criteria":"python -m legal_chatbot generate --template rental --output x.pdf works. Interactive mode collects all fields. Validation errors shown clearly.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:21:16.453807+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:21:16.453807+07:00","labels":["component:cli","phase:us4","spec:001-planning","story:US4"],"dependencies":[{"issue_id":"chatbot-1bv","depends_on_id":"chatbot-3z4","type":"parent-child","created_at":"2026-02-05T15:21:16.4569728+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-1j3","title":"Create document chunking service","description":"Implement intelligent chunking of legal documents for vector embedding","design":"Create crawler/src/indexers/chunker.py. Chunk by semantic boundaries (articles, sections) not just token count. Target 512-1024 tokens per chunk with 20% overlap. Preserve metadata: article_number, section, start/end offsets. Handle Vietnamese word boundaries.","acceptance_criteria":"Documents chunked at semantic boundaries, chunks 512-1024 tokens, metadata preserved, overlap correct","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:24:45.2698652+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:06:58.01669+07:00","closed_at":"2026-02-05T14:06:58.01669+07:00","close_reason":"Document chunking service implemented. Semantic chunking by articles (Điều), sentence-based chunking for long content, configurable chunk size (512 tokens default), overlap support (50 tokens), Vietnamese sentence detection, metadata preservation.","labels":["component:crawler","phase:us2","spec:001-planning","story:US2"],"dependencies":[{"issue_id":"chatbot-1j3","depends_on_id":"chatbot-206","type":"parent-child","created_at":"2026-02-04T16:24:45.3095072+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-1j3","depends_on_id":"chatbot-2bp","type":"blocks","created_at":"2026-02-04T16:24:45.3160573+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-1qr","title":"Phase 7: US5 - Document Generation","description":"User Story 5 (P3): Users can generate PDF/DOCX legal contracts. Uses Puppeteer for PDF, docxtemplater for DOCX, includes variable validation, watermarks for drafts, and legal disclaimers. Independent Test: User fills template variables, generates PDF, downloads file with watermark.","status":"closed","priority":3,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:21:33.2002567+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:27:16.0883429+07:00","closed_at":"2026-02-05T14:27:16.0883429+07:00","close_reason":"Phase 7: US5 - Document Generation complete. All 8 tasks done: variable validation, PDF generation with Puppeteer, DOCX generation with docxtemplater, GeneratedDocument service, document API endpoints, documents page, preview/download UI, generation form UI.","labels":["component:backend","component:frontend","phase:us5","spec:001-planning","story:US5"],"dependencies":[{"issue_id":"chatbot-1qr","depends_on_id":"chatbot-4n3","type":"parent-child","created_at":"2026-02-04T16:21:33.206827+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-1qr","depends_on_id":"chatbot-pul","type":"blocks","created_at":"2026-02-04T16:21:33.2100773+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-1qr","depends_on_id":"chatbot-fga","type":"blocks","created_at":"2026-02-04T16:21:33.2138944+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-1xb","title":"US4: Land Law Crawl Test Case","description":"Crawl Luat Dat dai 2024 + related nghi dinh as test case for the pipeline. Configure dat-dai category with verified URLs, implement HTML parser for thuvienphapluat.vn structure, run pipeline on 3+ documents, validate 200+ articles parsed, test semantic search returns relevant results. Depends on Pipeline Core (US3).","status":"open","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:18:08.7291135+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:18:08.7291135+07:00","labels":["component:pipeline","phase:test-case","spec:002-connect-db","story:US4"],"dependencies":[{"issue_id":"chatbot-1xb","depends_on_id":"chatbot-m3x","type":"parent-child","created_at":"2026-02-10T11:18:08.7317911+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-1xb","depends_on_id":"chatbot-4sx","type":"blocks","created_at":"2026-02-10T11:18:08.7364154+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-206","title":"Phase 4: US2 - Knowledge Base Crawler","description":"User Story 2 (P1): System can crawl and index legal documents from thuvienphapluat.vn. Includes Playwright scrapers, HTML/PDF parsers, vector embedding with bge-large-vi, and PostgreSQL indexing. Independent Test: Crawler can fetch, parse, chunk, embed, and store 10 sample legal documents.","status":"closed","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:21:10.9519059+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:12:08.2739497+07:00","closed_at":"2026-02-05T14:12:08.2739497+07:00","close_reason":"Phase 4: US2 - Knowledge Base Crawler complete. All 6 tasks done: Playwright scraper, HTML/PDF parsers, document chunking, vector embeddings, PostgreSQL indexer, crawler CLI.","labels":["component:crawler","phase:us2","spec:001-planning","story:US2"],"dependencies":[{"issue_id":"chatbot-206","depends_on_id":"chatbot-4n3","type":"parent-child","created_at":"2026-02-04T16:21:10.9583903+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-206","depends_on_id":"chatbot-9qs","type":"blocks","created_at":"2026-02-04T16:21:10.9629421+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-25w","title":"Initialize backend Node.js/TypeScript project","description":"Initialize Node.js project in backend/ with TypeScript 5.0+, Express/Fastify, and core dependencies","design":"Run npm init in backend/, install: typescript, @types/node, express, prisma, @prisma/client, pino, dotenv, zod. Configure tsconfig.json with strict mode. Add scripts: dev, build, start, test, lint","acceptance_criteria":"npm install succeeds, tsc compiles without errors, npm run dev starts server on port 3000","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:21:56.5848082+07:00","created_by":"Bao Lam","updated_at":"2026-02-04T17:23:17.9135666+07:00","closed_at":"2026-02-04T17:23:17.9135666+07:00","close_reason":"Backend Node.js/TypeScript project initialized with Express, Prisma, Pino, Zod. TypeScript compiles without errors. Scripts: dev, build, start, test, lint, db commands configured.","labels":["component:backend","phase:setup","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-25w","depends_on_id":"chatbot-5i0","type":"parent-child","created_at":"2026-02-04T16:21:56.6347422+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-25w","depends_on_id":"chatbot-95j","type":"blocks","created_at":"2026-02-04T16:21:56.6393808+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-2bp","title":"Implement HTML and PDF content parsers","description":"Create parsers to extract structured content from HTML pages and PDF documents","design":"Create crawler/src/parsers/html_parser.py and pdf_parser.py. HTML: BeautifulSoup to extract article text, preserve structure (chapters, sections, articles). PDF: pdfplumber to extract text with layout. Output: clean text with metadata (article numbers, sections).","acceptance_criteria":"HTML parser extracts clean text with article structure, PDF parser handles Vietnamese text, metadata extracted correctly","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:24:37.0823903+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:05:01.4137722+07:00","closed_at":"2026-02-05T14:05:01.4137722+07:00","close_reason":"HTML and PDF parsers implemented. HTMLParser: BeautifulSoup-based, extracts chapters/articles/sections, Vietnamese legal structure patterns (Điều, Chương, Mục). PDFParser: pdfplumber-based, extracts text and tables, page-by-page processing. PDFTextParser for cleaned PDF text.","labels":["component:crawler","phase:us2","spec:001-planning","story:US2"],"dependencies":[{"issue_id":"chatbot-2bp","depends_on_id":"chatbot-206","type":"parent-child","created_at":"2026-02-04T16:24:37.0865809+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-2bp","depends_on_id":"chatbot-809","type":"blocks","created_at":"2026-02-04T16:24:37.0925207+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-2ue","title":"Create variable validation service","description":"Implement validation of template variables before document generation","design":"Create backend/src/services/document/validation.service.ts. Validate: required fields present, type checking (string, number, date), format validation (dates in ISO, amounts positive). Return detailed errors per field.","acceptance_criteria":"Validation catches missing required fields, type errors detected, validation errors return field-level messages","status":"closed","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:27:00.99513+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:26:36.6523056+07:00","closed_at":"2026-02-05T14:26:36.6523056+07:00","close_reason":"Variable validation service already implemented in template.service.ts validateVariables method. Checks required/optional fields, types, and unknown fields.","labels":["component:backend","phase:us5","spec:001-planning","story:US5"],"dependencies":[{"issue_id":"chatbot-2ue","depends_on_id":"chatbot-1qr","type":"parent-child","created_at":"2026-02-04T16:27:01.0015397+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-2ue","depends_on_id":"chatbot-zu8","type":"blocks","created_at":"2026-02-04T16:27:01.0102353+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-309","title":"Implement PDF generation with Puppeteer","description":"Create PDF generation service using Puppeteer to render HTML templates","design":"Create backend/src/services/document/pdf.service.ts. Use Puppeteer to: render HTML template with Handlebars variables, add watermark CSS for drafts, generate PDF with A4 format, proper margins. Support Vietnamese fonts.","acceptance_criteria":"PDF generated from HTML template, variables replaced correctly, watermark appears on drafts, Vietnamese renders correctly","status":"closed","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:26:46.3894919+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:26:38.4112073+07:00","closed_at":"2026-02-05T14:26:38.4112073+07:00","close_reason":"PDF generation with Puppeteer implemented at backend/src/services/document/pdf.service.ts. Features: template interpolation, watermarks for drafts, legal footer, A4/Letter formats.","labels":["component:backend","phase:us5","spec:001-planning","story:US5"],"dependencies":[{"issue_id":"chatbot-309","depends_on_id":"chatbot-1qr","type":"parent-child","created_at":"2026-02-04T16:26:46.3958515+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-363","title":"Create pyproject.toml with project metadata","description":"Initialize Python project with pyproject.toml containing project metadata, dependencies, and build configuration.","design":"Create pyproject.toml at root with: name=legal_chatbot, version=0.1.0, python\u003e=3.11. Include all dependencies from plan.md. Configure black, isort, mypy, pytest in tool sections.","acceptance_criteria":"pyproject.toml exists with all required dependencies. pip install -e . succeeds.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:16:37.2532028+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:16:37.2532028+07:00","labels":["component:infra","phase:setup","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-363","depends_on_id":"chatbot-rvm","type":"parent-child","created_at":"2026-02-05T15:16:37.2579219+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-381","title":"Create Knowledge search API endpoints","description":"Implement REST endpoints for knowledge base search per openapi.yaml","design":"Create backend/src/api/routes/knowledge.ts. Endpoints: POST /knowledge/search (semantic search), GET /knowledge/documents/:id (get full document). Add filters for category, status. Return SearchResult[] with relevance scores.","acceptance_criteria":"Search endpoint returns relevant results, filters work, document endpoint returns full content, responses match openapi.yaml","status":"closed","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:25:50.0780512+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:16:40.021997+07:00","closed_at":"2026-02-05T14:16:40.021997+07:00","close_reason":"Knowledge search API endpoints implemented at backend/src/api/routes/knowledge.ts. Routes: POST /search, GET /stats, GET /documents/:id, GET /documents/:id/related, GET /citations/:messageId.","labels":["component:backend","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-381","depends_on_id":"chatbot-lu8","type":"parent-child","created_at":"2026-02-04T16:25:50.08353+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-381","depends_on_id":"chatbot-dab","type":"blocks","created_at":"2026-02-04T16:25:50.0915347+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-3hv","title":"Add normalize_for_embedding() NFC function","description":"Add normalize_for_embedding() to utils/vietnamese.py. Uses NFC normalization (NOT NFD). Rules: NFC normalize, collapse whitespace, do NOT lowercase, do NOT remove diacritics. This is separate from existing normalize_vietnamese() which uses NFD for keyword matching. Contract: contracts/embedding.md","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:17:21.4212567+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:17:21.4212567+07:00","labels":["component:utils","file:utils/vietnamese.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-3hv","depends_on_id":"chatbot-v0a","type":"parent-child","created_at":"2026-02-10T11:17:21.4228283+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-3la","title":"Extend config with Supabase settings","description":"Add Supabase and pipeline configuration to the Settings model","design":"Edit legal_chatbot/utils/config.py. Add fields: db_mode (str, default 'sqlite'), supabase_url, supabase_key, supabase_service_key, pipeline_crawl_interval, pipeline_rate_limit, pipeline_max_pages, embedding_model (default 'bkai-foundation-models/vietnamese-bi-encoder'), embedding_dimension (default 768). Load from .env via pydantic-settings. See spec section 9 and data-model.md.","acceptance_criteria":"Settings.db_mode reads from DB_MODE env var. Settings.supabase_url reads from SUPABASE_URL. All new fields have sensible defaults. Existing settings unchanged.","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:11:20.2895619+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:34:02.7909334+07:00","closed_at":"2026-02-10T11:34:02.7909334+07:00","close_reason":"Extended Settings with db_mode, supabase_*, pipeline_*, embedding_* fields","labels":["component:config","spec:002-connect-db","story:US1"],"dependencies":[{"issue_id":"chatbot-3la","depends_on_id":"chatbot-3mo","type":"parent-child","created_at":"2026-02-10T11:11:20.2921274+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-3mo","title":"US1: Supabase Integration","description":"Connect to Supabase PostgreSQL + pgvector + Storage as primary database with SQLite fallback. Implements dual-mode DB switching via strategy pattern.","status":"open","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:11:11.3471229+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:11:11.3471229+07:00","labels":["component:db","phase:foundational","spec:002-connect-db","story:US1"],"dependencies":[{"issue_id":"chatbot-3mo","depends_on_id":"chatbot-m3x","type":"parent-child","created_at":"2026-02-10T11:11:11.3502543+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-3p5","title":"Integrate audit into ChatService","description":"Update services/chat.py: after generating response in chat(), create ResearchAudit with session_id, query, sources (ArticleSource from retrieved articles), response text, and law_versions (via build_law_versions). Call save_research_audit(). Audit failure must NOT prevent chat from completing. Contract: contracts/audit.md integration section","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:18:47.0506404+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:18:47.0506404+07:00","labels":["component:services","file:services/chat.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-3p5","depends_on_id":"chatbot-w4o","type":"parent-child","created_at":"2026-02-10T11:18:47.0526965+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-3qc","title":"Integrate RAG into Message service","description":"Modify MessageService to use RAG pipeline for knowledge-augmented responses","design":"Update backend/src/services/chat/message.service.ts. Before calling Claude: retrieve relevant chunks via RAG. Include context in system prompt. After response: create citations. Return citations with message response.","acceptance_criteria":"Chat responses use knowledge base context, citations included in response, response quality improved for legal questions","status":"closed","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:25:57.8092457+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:16:50.3540728+07:00","closed_at":"2026-02-05T14:16:50.3540728+07:00","close_reason":"RAG integrated into message.service.ts streamMessage method. Retrieves context before Claude call, saves citations after response.","labels":["component:backend","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-3qc","depends_on_id":"chatbot-lu8","type":"parent-child","created_at":"2026-02-04T16:25:57.8148035+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-3qc","depends_on_id":"chatbot-9qr","type":"blocks","created_at":"2026-02-04T16:25:57.8223006+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-3qc","depends_on_id":"chatbot-u3m","type":"blocks","created_at":"2026-02-04T16:25:57.8313324+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-3r9","title":"Implement semantic search function","description":"Implement semantic search over indexed articles.","design":"In services/indexer.py add search() method: embed query using same model, query ChromaDB with top-k, fetch full article content from SQLite, return SearchResult objects with scores and context.","acceptance_criteria":"Search returns relevant articles. Scores reflect semantic similarity. Full content retrieved.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:19:30.5451448+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:19:30.5451448+07:00","labels":["component:indexer","phase:us2","spec:001-planning","story:US2"],"dependencies":[{"issue_id":"chatbot-3r9","depends_on_id":"chatbot-hy0","type":"parent-child","created_at":"2026-02-05T15:19:30.5488955+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-3z4","title":"Phase 6: US4 - Document Generator","description":"User Story 4: As a user, I want to generate PDF contracts from templates so that I have legally-formatted documents. Goal: Template-based PDF generation. Test: python -m legal_chatbot generate --template rental --output contract.pdf creates valid PDF.","status":"open","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:20:40.1253707+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:20:40.1253707+07:00","labels":["component:generator","phase:us4","spec:001-planning","story:US4"],"dependencies":[{"issue_id":"chatbot-3z4","depends_on_id":"chatbot-bzv","type":"parent-child","created_at":"2026-02-05T15:20:40.1291036+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-3z4","depends_on_id":"chatbot-t2s","type":"blocks","created_at":"2026-02-05T15:22:47.9543574+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-42t","title":"Implement abstract DatabaseInterface","description":"Create abstract base class for database operations enabling SQLite/Supabase switching","design":"Create legal_chatbot/db/base.py. Define DatabaseInterface ABC with methods: init_db(), insert_document(dict)-\u003estr, insert_articles(list[dict])-\u003eint, get_document(str)-\u003eOptional[dict], get_documents_by_category(str)-\u003elist[dict], search_articles(query_embedding, top_k, status)-\u003elist[dict], get_document_by_hash(str)-\u003eOptional[dict], upsert_document(dict)-\u003estr, insert_category(dict)-\u003estr, get_category(str)-\u003eOptional[dict]. Also add factory function get_database(mode)-\u003eDatabaseInterface. See contracts/supabase-client.md.","acceptance_criteria":"DatabaseInterface importable. All abstract methods defined. get_database('sqlite') returns existing SQLite implementation (wrapper). get_database('supabase') returns SupabaseClient.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:11:43.9318048+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:11:43.9318048+07:00","labels":["component:db","spec:002-connect-db","story:US1"],"dependencies":[{"issue_id":"chatbot-42t","depends_on_id":"chatbot-3mo","type":"parent-child","created_at":"2026-02-10T11:11:43.933405+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-42t","depends_on_id":"chatbot-pfr","type":"blocks","created_at":"2026-02-10T11:11:43.9371565+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-4m1","title":"Setup \u0026 Dependencies","description":"Install new dependencies and configure environment for Supabase + embedding pipeline","status":"closed","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:10:41.5707904+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:34:02.6383189+07:00","closed_at":"2026-02-10T11:34:02.6383189+07:00","close_reason":"Setup phase complete","labels":["component:infra","phase:setup","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-4m1","depends_on_id":"chatbot-m3x","type":"parent-child","created_at":"2026-02-10T11:10:41.5738729+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-4n3","title":"Legal Chatbot","description":"Build a legal chatbot interface for a Vietnamese law firm that enables users to ask legal questions and receive accurate consultation along with appropriate contract/legal document templates. Uses pre-indexed knowledge base from thuvienphapluat.vn, AI-powered chat agent with Claude API, and document generator for PDF/DOCX output.","status":"closed","priority":1,"issue_type":"epic","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:20:41.8381866+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:30:35.059872+07:00","closed_at":"2026-02-05T14:30:35.059872+07:00","close_reason":"Legal Chatbot epic complete! All 8 phases implemented: Setup, Foundational, Basic Chat, Knowledge Base Crawler, Knowledge Retrieval with Citations, Document Templates, Document Generation, Polish and Cross-Cutting. 58 tasks closed.","labels":["component:backend","component:crawler","component:webapp","spec:001-planning"]}
{"id":"chatbot-4sx","title":"US3: Data Pipeline Core","description":"Build the 4-phase data pipeline: Discovery -\u003e Crawl \u0026 Parse -\u003e Index \u0026 Embed -\u003e Validate. Orchestrate crawling of legal documents by category with Playwright stealth for Cloudflare bypass, content hashing for change detection, and embedding generation. Contract: contracts/pipeline.md","status":"open","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:17:37.2870209+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:17:37.2870209+07:00","labels":["component:pipeline","phase:pipeline","spec:002-connect-db","story:US3"],"dependencies":[{"issue_id":"chatbot-4sx","depends_on_id":"chatbot-m3x","type":"parent-child","created_at":"2026-02-10T11:17:37.2890926+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-4sx","depends_on_id":"chatbot-v0a","type":"blocks","created_at":"2026-02-10T11:17:37.2932782+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-4yw","title":"Implement Conversation service","description":"Create ConversationService with CRUD operations for chat conversations","design":"Create backend/src/services/chat/conversation.service.ts. Methods: create(userId, title?, metadata?), findById(id), findByUser(userId, status, pagination), update(id, data), delete(id). Use Prisma client. Include soft delete via status=archived.","acceptance_criteria":"All CRUD operations work, conversations scoped to user, pagination works correctly, metadata stored as JSONB","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:23:23.7058767+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:01:45.3911772+07:00","closed_at":"2026-02-05T14:01:45.3911772+07:00","close_reason":"ConversationService implemented with CRUD operations: create, findById, findByUser (with pagination), update, delete (soft), hardDelete. Prisma client integration, ownership verification, status filtering.","labels":["component:backend","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-4yw","depends_on_id":"chatbot-fga","type":"parent-child","created_at":"2026-02-04T16:23:23.7120214+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-57d","title":"Unit tests for audit service","description":"Create tests/unit/test_audit.py. Tests: save and retrieve research audit, save and retrieve contract audit, verify current laws returns is_current=True, verify outdated laws detects changes, list audits returns combined sorted list, audit failure does not fail main operation (mock DB failure). Contract: contracts/audit.md testing section","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:18:53.9786341+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:18:53.9786341+07:00","labels":["component:tests","file:tests/unit/test_audit.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-57d","depends_on_id":"chatbot-w4o","type":"parent-child","created_at":"2026-02-10T11:18:53.9806814+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-57z","title":"Create models/audit.py","description":"Create models/audit.py with Pydantic models: ResearchAudit (id, session_id, query, sources list, response, law_versions, created_at), ContractAudit (id, contract_type, input_data, generated_content, legal_references, law_versions, pdf_storage_path, created_at), LawVersion (document_id, document_number, title, status_at_query, effective_date), ArticleSource (article_id, article_number, document_title, similarity). Contract: contracts/audit.md","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:18:40.6020353+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:18:40.6020353+07:00","labels":["component:models","file:models/audit.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-57z","depends_on_id":"chatbot-w4o","type":"parent-child","created_at":"2026-02-10T11:18:40.6040851+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-5h5","title":"Create Template API endpoints","description":"Implement REST endpoints for template listing per openapi.yaml","design":"Create backend/src/api/routes/templates.ts. Endpoints: GET /templates (list with category filter). Return DocumentTemplate[] with id, name, category, requiredFields, optionalFields. Admin-only endpoints for CRUD can be added later.","acceptance_criteria":"Template list endpoint works, category filter works, required fields schema returned correctly","status":"closed","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:26:29.5287978+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:08:56.4001576+07:00","closed_at":"2026-02-05T14:08:56.4001576+07:00","close_reason":"Template API endpoints updated to use DocumentTemplateService. GET /templates (list with category filter), POST /documents/generate, GET /documents/:id, POST /documents/validate. Full validation and error handling.","labels":["component:backend","phase:us4","spec:001-planning","story:US4"],"dependencies":[{"issue_id":"chatbot-5h5","depends_on_id":"chatbot-pul","type":"parent-child","created_at":"2026-02-04T16:26:29.5334646+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-5h5","depends_on_id":"chatbot-zu8","type":"blocks","created_at":"2026-02-04T16:26:29.5407106+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-5i0","title":"Phase 1: Setup","description":"Project initialization and shared infrastructure setup. Create monorepo structure with backend (Node.js/TypeScript), frontend (Next.js), and crawler (Python) services.","status":"closed","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:20:49.0204448+07:00","created_by":"Bao Lam","updated_at":"2026-02-04T17:31:14.207899+07:00","closed_at":"2026-02-04T17:31:14.207899+07:00","close_reason":"Phase 1 Setup complete. All 6 tasks done: monorepo structure, backend/frontend/crawler initialization, linting, environment configuration.","labels":["component:infra","phase:setup","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-5i0","depends_on_id":"chatbot-4n3","type":"parent-child","created_at":"2026-02-04T16:20:49.0255805+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-5z5","title":"Add logging throughout application","description":"Add structured logging to all modules for observability.","design":"Use Python logging module. Create utils/logging.py with setup_logging() that configures formatters, handlers. Add info/debug/error logging to crawler, indexer, chat, generator services. Include request IDs for tracing.","acceptance_criteria":"Logs show operation flow. Errors logged with context. Log levels configurable via LOG_LEVEL env.","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:21:47.733649+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:21:47.733649+07:00","labels":["component:infra","phase:polish","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-5z5","depends_on_id":"chatbot-day","type":"parent-child","created_at":"2026-02-05T15:21:47.736824+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-67a","title":"Create initial contract templates","description":"Create HTML/DOCX templates for common Vietnamese legal contracts","design":"Create backend/templates/rental/ (rental agreement), backend/templates/employment/ (labor contract). Use Handlebars syntax {{variable}}. Include Vietnamese legal language. Define required_fields in JSON schema. Add watermark CSS for drafts.","acceptance_criteria":"Templates render correctly with test data, Vietnamese text displays properly, watermarks appear on drafts","status":"closed","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:26:22.4859075+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:08:58.680158+07:00","closed_at":"2026-02-05T14:08:58.680158+07:00","close_reason":"Initial rental contract template created in backend/templates/rental-contract.html. Vietnamese legal format with: party info, property details, rental terms, payment terms, deposit, rights/obligations, signatures. Uses Handlebars-style variables.","labels":["component:backend","phase:us4","spec:001-planning","story:US4"],"dependencies":[{"issue_id":"chatbot-67a","depends_on_id":"chatbot-pul","type":"parent-child","created_at":"2026-02-04T16:26:22.4913218+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-67a","depends_on_id":"chatbot-zu8","type":"blocks","created_at":"2026-02-04T16:26:22.4996894+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-6jw","title":"Implement ReportLab PDF generator","description":"Generate PDF documents using ReportLab from template and data.","design":"In services/generator.py add generate_pdf() method using ReportLab: create document with A4 page, add title/header, Vietnamese font support (register DejaVuSans), fill template sections with data, add disclaimer watermark, add page numbers. Return path to generated PDF.","acceptance_criteria":"PDF generated with correct layout. Vietnamese text renders properly. Disclaimer included.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:21:04.2107492+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:21:04.2107492+07:00","labels":["component:generator","phase:us4","spec:001-planning","story:US4"],"dependencies":[{"issue_id":"chatbot-6jw","depends_on_id":"chatbot-3z4","type":"parent-child","created_at":"2026-02-05T15:21:04.2138674+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-6o2","title":"Write integration tests for RAG pipeline","description":"Create integration tests for the complete RAG pipeline.","design":"Create tests/integration/test_rag_pipeline.py: test end-to-end flow from indexing sample document to chat query to response. Verify citations match indexed content. Test with Vietnamese legal text samples.","acceptance_criteria":"RAG pipeline tested end-to-end. Tests pass with sample data. Citations verified.","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:21:53.8226295+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:21:53.8226295+07:00","labels":["component:test","phase:polish","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-6o2","depends_on_id":"chatbot-day","type":"parent-child","created_at":"2026-02-05T15:21:53.8257448+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-6w2","title":"Create Prisma schema with core models","description":"Define Prisma schema with User, Conversation, Message, LegalDocument, DocumentChunk, Citation, DocumentTemplate, GeneratedDocument models per data-model.md","design":"Create backend/prisma/schema.prisma. Define all 8 entities from data-model.md. Use @db.Vector(1024) for embeddings. Add proper indexes. Configure postgresql provider.","acceptance_criteria":"npx prisma generate succeeds, npx prisma migrate dev creates all tables, pgvector column works","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:22:43.0139331+07:00","created_by":"Bao Lam","updated_at":"2026-02-04T18:01:39.876351+07:00","closed_at":"2026-02-04T18:01:39.876351+07:00","close_reason":"Prisma schema created with all 8 entities from data-model.md: User, Conversation, Message, LegalDocument, DocumentChunk, Citation, DocumentTemplate, GeneratedDocument. Vector(1024) configured for embeddings. All enums and indexes defined.","labels":["component:backend","component:db","phase:foundational","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-6w2","depends_on_id":"chatbot-9qs","type":"parent-child","created_at":"2026-02-04T16:22:43.0182197+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-6w2","depends_on_id":"chatbot-zpx","type":"blocks","created_at":"2026-02-04T16:22:43.02333+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-6y7","title":"Add audit CLI command group","description":"Add audit command group to CLI: 'audit list --limit N --type all|research|contract' shows recent audits in Rich table, 'audit verify \u003caudit-id\u003e' checks if law versions are still current, 'audit show \u003caudit-id\u003e' displays full audit details. Contract: contracts/audit.md CLI section","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:18:51.001656+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:18:51.001656+07:00","labels":["component:cli","file:cli/main.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-6y7","depends_on_id":"chatbot-w4o","type":"parent-child","created_at":"2026-02-10T11:18:51.0037804+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-70w","title":"Configure dat-dai category with verified URLs","description":"Create CategoryConfig for dat_dai with verified URLs from research: Luat Dat dai 2024 (31/2024/QH15), ND 102/2024, ND 101/2024. Set crawl_url, document_urls list, max_pages=20, rate_limit_seconds=4.0. Depends on models/pipeline.py (chatbot-m2e).","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:18:15.2543439+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:18:15.2543439+07:00","labels":["component:config","spec:002-connect-db","story:US4"],"dependencies":[{"issue_id":"chatbot-70w","depends_on_id":"chatbot-1xb","type":"parent-child","created_at":"2026-02-10T11:18:15.2563765+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-70w","depends_on_id":"chatbot-m2e","type":"blocks","created_at":"2026-02-10T11:18:15.2615265+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-71v","title":"Implement GeneratedDocument service","description":"Create service to orchestrate document generation and storage","design":"Create backend/src/services/document/generator.service.ts. Methods: generate(templateId, variables, format), validate(templateId, variables), findByUser(userId). Store generated files in uploads/, save metadata to GeneratedDocument table. Link to conversation if provided.","acceptance_criteria":"Documents generated and stored, metadata saved to DB, files retrievable by ID, conversation linking works","status":"closed","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:27:08.8269851+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:26:45.0579538+07:00","closed_at":"2026-02-05T14:26:45.0579538+07:00","close_reason":"GeneratedDocument service implemented at backend/src/services/document/generation.service.ts. Orchestrates PDF/DOCX generation, storage, finalization, and retrieval.","labels":["component:backend","phase:us5","spec:001-planning","story:US5"],"dependencies":[{"issue_id":"chatbot-71v","depends_on_id":"chatbot-1qr","type":"parent-child","created_at":"2026-02-04T16:27:08.8332171+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-71v","depends_on_id":"chatbot-309","type":"blocks","created_at":"2026-02-04T16:27:08.8412661+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-71v","depends_on_id":"chatbot-05x","type":"blocks","created_at":"2026-02-04T16:27:08.8492912+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-71v","depends_on_id":"chatbot-2ue","type":"blocks","created_at":"2026-02-04T16:27:08.8587159+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-71w","title":"Add index CLI command","description":"Implement CLI command for indexing crawled documents.","design":"Create legal_chatbot/cli/index.py with: index command accepting --input (path to raw files), --verbose flag. Call IndexerService.index_from_directory(). Show progress bar with Rich. Print summary with document and article counts.","acceptance_criteria":"python -m legal_chatbot index --input ./data/raw indexes all files. Progress shown. Summary printed.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:19:24.4259459+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:19:24.4259459+07:00","labels":["component:cli","phase:us2","spec:001-planning","story:US2"],"dependencies":[{"issue_id":"chatbot-71w","depends_on_id":"chatbot-hy0","type":"parent-child","created_at":"2026-02-05T15:19:24.4291464+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-7cc","title":"Validate quickstart.md end-to-end","description":"Follow quickstart.md from scratch and verify all steps work correctly","design":"Fresh clone of repo, follow every step in specs/001-planning/quickstart.md. Document any errors or unclear instructions. Update quickstart.md with fixes. Verify: install, db setup, migrations, dev servers, health check, test chat.","acceptance_criteria":"New developer can follow quickstart.md successfully, all commands work, app runs correctly","status":"closed","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:28:21.6899491+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:30:18.8080993+07:00","closed_at":"2026-02-05T14:30:18.8080993+07:00","close_reason":"Quickstart.md validated and updated with correct ports (backend:3001, frontend:3000), docker compose option added, API URLs corrected.","labels":["component:docs","phase:polish","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-7cc","depends_on_id":"chatbot-rts","type":"parent-child","created_at":"2026-02-04T16:28:21.6971348+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-7cc","depends_on_id":"chatbot-ut0","type":"blocks","created_at":"2026-02-04T16:28:21.71116+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-7rn","title":"Implement Message service with Claude API","description":"Create MessageService that stores messages and calls Claude API for responses","design":"Create backend/src/services/chat/message.service.ts. Methods: create(conversationId, role, content), findByConversation(conversationId, pagination). Integrate @anthropic-ai/sdk for Claude API. Track token_count and model_used. Add legal disclaimer to system prompt.","acceptance_criteria":"User messages saved, Claude API called, assistant response saved with token count, streaming supported","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:23:32.0648095+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:04:56.3677706+07:00","closed_at":"2026-02-05T14:04:56.3677706+07:00","close_reason":"MessageService implemented with Claude API integration. Features: create/findByConversation, sendMessage (sync), streamMessage (async generator for SSE), Vietnamese legal system prompt, token tracking, model tracking. Uses @anthropic-ai/sdk.","labels":["component:backend","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-7rn","depends_on_id":"chatbot-fga","type":"parent-child","created_at":"2026-02-04T16:23:32.0696974+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-7rn","depends_on_id":"chatbot-4yw","type":"blocks","created_at":"2026-02-04T16:23:32.0765269+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-7yf","title":"Setup environment configuration","description":"Create .env.example files and environment loading for all services","design":"Create backend/.env.example with DATABASE_URL, ANTHROPIC_API_KEY, JWT_SECRET, HUGGINGFACE_API_KEY. Create frontend/.env.example with NEXT_PUBLIC_API_URL. Create crawler/.env.example with DATABASE_URL, HUGGINGFACE_API_KEY. Update .gitignore to exclude .env files.","acceptance_criteria":".env.example exists in all projects, dotenv loads configs correctly, sensitive keys not committed","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:22:27.294927+07:00","created_by":"Bao Lam","updated_at":"2026-02-04T17:30:46.1352047+07:00","closed_at":"2026-02-04T17:30:46.1352047+07:00","close_reason":".env.example files created for all three projects (backend, frontend, crawler). Root .gitignore updated with Python patterns. All environment variables documented including DATABASE_URL, API keys, JWT secret.","labels":["component:infra","phase:setup","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-7yf","depends_on_id":"chatbot-5i0","type":"parent-child","created_at":"2026-02-04T16:22:27.2997107+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-7yf","depends_on_id":"chatbot-25w","type":"blocks","created_at":"2026-02-04T16:22:27.3034895+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-7yf","depends_on_id":"chatbot-15l","type":"blocks","created_at":"2026-02-04T16:22:27.3072278+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-7yf","depends_on_id":"chatbot-18y","type":"blocks","created_at":"2026-02-04T16:22:27.3122456+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-809","title":"Create Playwright scraper for thuvienphapluat.vn","description":"Build Playwright-based web scraper to crawl legal documents from thuvienphapluat.vn","design":"Create crawler/src/scrapers/thuvienphapluat.py. Use Playwright async API. Extract: document title, document_number, category, effective_date, content HTML. Implement rate limiting (1 req/3s). Handle Vietnamese encoding. Follow robots.txt.","acceptance_criteria":"Scraper fetches document pages, extracts all required fields, respects rate limits, handles JavaScript-rendered content","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:24:28.5638977+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:01:47.5754044+07:00","closed_at":"2026-02-05T14:01:47.5754044+07:00","close_reason":"Playwright scraper for thuvienphapluat.vn implemented. Features: async API, rate limiting (3s), Vietnamese encoding, document extraction (title, number, category, effective_date, content HTML/text, issuing_body), URL listing by category.","labels":["component:crawler","phase:us2","spec:001-planning","story:US2"],"dependencies":[{"issue_id":"chatbot-809","depends_on_id":"chatbot-206","type":"parent-child","created_at":"2026-02-04T16:24:28.5712467+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-80j","title":"Implement split_long_article() for token limit","description":"Add split_long_article() to EmbeddingService. Split articles \u003e380 chars (~256 PhoBERT tokens) by Khoan (clause). Prepend Dieu header to each chunk. Set chunk_index \u003e 0 for splits. Contract: contracts/embedding.md","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:17:24.5078705+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:17:24.5078705+07:00","labels":["component:services","file:services/embedding.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-80j","depends_on_id":"chatbot-v0a","type":"parent-child","created_at":"2026-02-10T11:17:24.5099344+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-8ac","title":"Implement HTML parser for legal documents","description":"Parse HTML content to extract legal document metadata and article structure.","design":"In services/crawler.py add parse_document() method using BeautifulSoup: extract document_number, title, effective_date, issuing_authority from HTML. Identify article boundaries (Điều patterns). Return structured data matching LegalDocument model.","acceptance_criteria":"Parser extracts all metadata fields. Article boundaries detected. Vietnamese text preserved.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:18:27.3397863+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:18:27.3397863+07:00","labels":["component:crawler","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-8ac","depends_on_id":"chatbot-8ir","type":"parent-child","created_at":"2026-02-05T15:18:27.3440151+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-8ai","title":"Implement embed_and_store() for Supabase","description":"Add embed_and_store() to EmbeddingService. Full pipeline: extract content from articles, call embed_batch(), upsert to Supabase articles table via SupabaseClient in chunks of 50. Depends on SupabaseClient (chatbot-cut). Contract: contracts/embedding.md","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:17:25.9931569+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:17:25.9931569+07:00","labels":["component:services","file:services/embedding.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-8ai","depends_on_id":"chatbot-v0a","type":"parent-child","created_at":"2026-02-10T11:17:25.9952507+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-8ai","depends_on_id":"chatbot-cut","type":"blocks","created_at":"2026-02-10T11:17:25.9993799+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-8ir","title":"Phase 3: US1 - Data Crawler","description":"User Story 1: As a legal admin, I want to crawl legal documents from thuvienphapluat.vn so that I can build a knowledge base. Goal: Fetch and store Vietnamese legal documents. Test: python -m legal_chatbot crawl --limit 5 returns 5 documents.","status":"open","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:18:08.76276+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:18:08.76276+07:00","labels":["component:crawler","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-8ir","depends_on_id":"chatbot-bzv","type":"parent-child","created_at":"2026-02-05T15:18:08.7658905+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-8ir","depends_on_id":"chatbot-t2s","type":"blocks","created_at":"2026-02-05T15:22:29.7559238+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-8ml","title":"Connect DB \u0026 Design Data Pipeline","description":"Extend Legal Chatbot with Supabase (PostgreSQL + pgvector), automated data pipeline for Vietnamese legal documents, and audit trail. Test case: crawl Luat Dat dai 2024. See specs/002-connect-db-and-design-data-pipeline/","status":"closed","priority":1,"issue_type":"epic","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:09:55.9419082+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:20:03.990257+07:00","closed_at":"2026-02-10T11:20:03.990257+07:00","close_reason":"Duplicate epic, using chatbot-m3x instead","labels":["component:db","component:embedding","component:pipeline","spec:002-connect-db"]}
{"id":"chatbot-8xm","title":"Create documents page with generation flow","description":"Create Next.js page integrating template selection, form, and preview","design":"Create frontend/src/app/documents/page.tsx, frontend/src/app/documents/generate/[templateId]/page.tsx. Flow: list templates -\u003e select -\u003e fill form -\u003e preview -\u003e download. Add navigation from chat (suggest document generation).","acceptance_criteria":"Full generation flow works end-to-end, navigation clear, can generate from chat context if available","status":"closed","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:27:39.591623+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:27:05.0652253+07:00","closed_at":"2026-02-05T14:27:05.0652253+07:00","close_reason":"Documents page created at frontend/src/app/documents/page.tsx. Lists user documents with pagination, download links, and status indicators.","labels":["component:frontend","phase:us5","spec:001-planning","story:US5"],"dependencies":[{"issue_id":"chatbot-8xm","depends_on_id":"chatbot-1qr","type":"parent-child","created_at":"2026-02-04T16:27:39.5973771+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-8xm","depends_on_id":"chatbot-bdw","type":"blocks","created_at":"2026-02-04T16:27:39.6074409+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-91o","title":"Create chat page with streaming support","description":"Create Next.js chat page that integrates all chat components with real-time streaming","design":"Create frontend/src/app/chat/page.tsx and frontend/src/app/chat/[conversationId]/page.tsx. Integrate ConversationList, ChatWindow. Handle SSE streaming for message responses. Add loading states, error handling.","acceptance_criteria":"Chat page loads conversations, new conversation creates correctly, messages stream in real-time, Vietnamese displays properly","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:24:11.1003311+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:06:55.6604002+07:00","closed_at":"2026-02-05T14:06:55.6604002+07:00","close_reason":"Chat page with streaming support implemented at /chat/[id]. Features: conversation loading, streaming messages display, back navigation, loading states, error handling. Uses ChatContainer component.","labels":["component:frontend","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-91o","depends_on_id":"chatbot-fga","type":"parent-child","created_at":"2026-02-04T16:24:11.1067696+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-91o","depends_on_id":"chatbot-jo3","type":"blocks","created_at":"2026-02-04T16:24:11.1118706+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-94k","title":"Add citation display to Chat UI","description":"Update chat UI to display citations with expandable references","design":"Create frontend/src/components/chat/CitationList.tsx. Show citations below assistant messages. Each citation: document title, article number, excerpt (collapsible). Link to view full document. Style with distinct background.","acceptance_criteria":"Citations display after assistant messages, expandable excerpts work, document links open detail view","status":"closed","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:26:05.9561838+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:16:55.6520042+07:00","closed_at":"2026-02-05T14:16:55.6520042+07:00","close_reason":"Citation display in Chat UI already implemented at frontend/src/components/chat/ChatMessage.tsx and CitationPanel.tsx. Shows citations with document info, relevance, and excerpts.","labels":["component:frontend","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-94k","depends_on_id":"chatbot-lu8","type":"parent-child","created_at":"2026-02-04T16:26:05.9940995+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-94k","depends_on_id":"chatbot-3qc","type":"blocks","created_at":"2026-02-04T16:26:06.0025657+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-95j","title":"Create monorepo project structure","description":"Create the monorepo directory structure with backend/, frontend/, crawler/, and shared/ directories as defined in plan.md","design":"Create directories: backend/src/{models,services,api,lib}, backend/tests/{unit,integration,contract}, frontend/src/{components,pages,services,hooks}, frontend/tests, crawler/src/{scrapers,parsers,indexers,cli}, crawler/tests, shared/{types,contracts}. Follow plan.md structure exactly.","acceptance_criteria":"All directories exist, .gitkeep files added where needed, structure matches plan.md","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:21:48.8528822+07:00","created_by":"Bao Lam","updated_at":"2026-02-04T17:11:33.460053+07:00","closed_at":"2026-02-04T17:11:33.460053+07:00","close_reason":"Monorepo structure created: backend/{src/{models,services/{chat,knowledge,document},api,lib},tests/{unit,integration,contract}}, frontend/{src/{components/{chat,document},pages,services,hooks},tests}, crawler/{src/{scrapers,parsers,indexers,cli},tests}, shared/{types,contracts}. All directories created with .gitkeep files.","labels":["component:infra","phase:setup","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-95j","depends_on_id":"chatbot-5i0","type":"parent-child","created_at":"2026-02-04T16:21:48.8571609+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-984","title":"Implement ChromaDB vector store operations","description":"Create ChromaDB module for vector storage and semantic search.","design":"Create legal_chatbot/db/chroma.py with: init_chroma() to setup persistent client, create_collection() for legal_articles and contract_templates, add_documents() with embeddings, search() for semantic retrieval. Use sentence-transformers for embeddings.","acceptance_criteria":"ChromaDB collection created. Documents can be added and searched. Embeddings generated correctly.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:17:41.8164897+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:17:41.8164897+07:00","labels":["component:db","phase:foundational","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-984","depends_on_id":"chatbot-t2s","type":"parent-child","created_at":"2026-02-05T15:17:41.8195949+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-9ac","title":"Implement embedding generation","description":"Generate embeddings for articles using sentence-transformers.","design":"In services/indexer.py: use sentence-transformers paraphrase-multilingual-MiniLM-L12-v2 model. Normalize Vietnamese text before embedding. Batch embedding generation for efficiency. Return 384-dim vectors.","acceptance_criteria":"Embeddings generated for Vietnamese legal text. Batch processing works. Vectors are normalized.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:19:12.0514107+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:19:12.0514107+07:00","labels":["component:indexer","phase:us2","spec:001-planning","story:US2"],"dependencies":[{"issue_id":"chatbot-9ac","depends_on_id":"chatbot-hy0","type":"parent-child","created_at":"2026-02-05T15:19:12.0552236+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-9qr","title":"Implement RAG pipeline with LlamaIndex","description":"Create RAG pipeline that retrieves context and generates responses with citations","design":"Create backend/src/services/knowledge/rag.service.ts. Use LlamaIndex for retrieval orchestration. Steps: embed query, retrieve top-K chunks, build context prompt, call Claude API, extract citations from response. Track which chunks were used.","acceptance_criteria":"RAG retrieves relevant context, Claude response uses context, citations tracked, response quality good for legal questions","status":"closed","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:25:33.3410941+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:16:38.5784438+07:00","closed_at":"2026-02-05T14:16:38.5784438+07:00","close_reason":"RAG pipeline created at backend/src/services/knowledge/rag.service.ts. Integrates search, citations, and context building for LLM prompts.","labels":["component:backend","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-9qr","depends_on_id":"chatbot-lu8","type":"parent-child","created_at":"2026-02-04T16:25:33.3460864+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-9qr","depends_on_id":"chatbot-dab","type":"blocks","created_at":"2026-02-04T16:25:33.3523606+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-9qr","depends_on_id":"chatbot-hxf","type":"blocks","created_at":"2026-02-04T16:25:33.3592125+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-9qs","title":"Phase 2: Foundational","description":"Core infrastructure that MUST complete before ANY user story. Includes database schema with pgvector, authentication framework, API routing, and base entity models.","status":"closed","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:20:55.4946705+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T13:55:56.9288453+07:00","closed_at":"2026-02-05T13:55:56.9288453+07:00","close_reason":"Phase 2 Foundational complete. All 6 tasks done: PostgreSQL+pgvector, Prisma schema (8 entities), shared types, JWT auth, Express routing (5 route groups), Pino logging with correlation IDs.","labels":["component:backend","component:db","phase:foundational","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-9qs","depends_on_id":"chatbot-4n3","type":"parent-child","created_at":"2026-02-04T16:20:55.5010404+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-9qs","depends_on_id":"chatbot-5i0","type":"blocks","created_at":"2026-02-04T16:20:55.5037034+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-9yf","title":"Implement Groq API client","description":"Create Groq API client for LLM interactions.","design":"Create legal_chatbot/services/chat.py with GroqClient class: initialize with API key from config, chat_completion() method using llama-3.3-70b-versatile model, handle rate limits with retry, return structured response.","acceptance_criteria":"Groq API calls work. Model responses received. Rate limits handled gracefully.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:19:56.1102797+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:19:56.1102797+07:00","labels":["component:chat","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-9yf","depends_on_id":"chatbot-17y","type":"parent-child","created_at":"2026-02-05T15:19:56.1138973+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-9z4","title":"Implement HTML parser for thuvienphapluat.vn","description":"Implement parser for thuvienphapluat.vn HTML structure. Extract: document metadata (title, doc_number, issue_date, effective_date, issuing_body, status), articles (Dieu) with content, Vietnamese legal hierarchy (Phan/Chuong/Muc/Dieu). Use BeautifulSoup. Handle various document formats on the site.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:18:18.2976141+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:18:18.2976141+07:00","labels":["component:services","file:services/indexer.py","spec:002-connect-db","story:US4"],"dependencies":[{"issue_id":"chatbot-9z4","depends_on_id":"chatbot-1xb","type":"parent-child","created_at":"2026-02-10T11:18:18.3001755+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-akk","title":"Create system prompt for legal assistant","description":"Design system prompt for Vietnamese legal assistant that grounds answers in retrieved context.","design":"In services/chat.py: create SYSTEM_PROMPT constant with Vietnamese instructions: answer based ONLY on provided articles, always cite sources (Dieu number, document name), if no relevant info say so, suggest templates when appropriate. Include disclaimer about reference-only nature.","acceptance_criteria":"System prompt enforces grounded responses. Vietnamese instructions clear. Disclaimer included.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:20:08.4309757+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:20:08.4309757+07:00","labels":["component:chat","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-akk","depends_on_id":"chatbot-17y","type":"parent-child","created_at":"2026-02-05T15:20:08.4341384+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-alt","title":"Create package directory structure","description":"Create the legal_chatbot package directory structure with all required submodules.","design":"Create directories: legal_chatbot/, legal_chatbot/cli/, legal_chatbot/services/, legal_chatbot/models/, legal_chatbot/db/, legal_chatbot/templates/, legal_chatbot/utils/. Add __init__.py to each.","acceptance_criteria":"All directories exist with __init__.py files. Package is importable.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:16:43.3538349+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:16:43.3538349+07:00","labels":["component:infra","phase:setup","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-alt","depends_on_id":"chatbot-rvm","type":"parent-child","created_at":"2026-02-05T15:16:43.3572867+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-b0j","title":"Update requirements.txt","description":"Add new dependencies: supabase\u003e=2.0.0, sentence-transformers\u003e=2.2.0, playwright-stealth\u003e=1.0.0, apscheduler\u003e=3.10.0, datasets\u003e=2.0.0","design":"Edit requirements.txt at repo root. Add under a '# 002 - DB \u0026 Pipeline' section. Keep existing deps. Run pip install -r requirements.txt and playwright install firefox to verify.","acceptance_criteria":"All new packages install without errors. python -c 'import supabase; import sentence_transformers; print(\"OK\")' succeeds.","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:10:53.6329534+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:34:02.3355587+07:00","closed_at":"2026-02-10T11:34:02.3355587+07:00","close_reason":"Added supabase, sentence-transformers, playwright, playwright-stealth, apscheduler to pyproject.toml","labels":["component:infra","phase:setup","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-b0j","depends_on_id":"chatbot-4m1","type":"parent-child","created_at":"2026-02-10T11:10:53.6356325+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-b1l","title":"Run pipeline on dat-dai category (3 docs min)","description":"Execute full pipeline on dat_dai category: crawl 3+ land law documents, parse 200+ articles, generate 768d embeddings, store in Supabase. Verify pipeline_runs table logged correctly. Depends on PipelineService (chatbot-k5b). This is an integration/acceptance task.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:18:21.0491895+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:18:21.0491895+07:00","labels":["component:pipeline","spec:002-connect-db","story:US4"],"dependencies":[{"issue_id":"chatbot-b1l","depends_on_id":"chatbot-1xb","type":"parent-child","created_at":"2026-02-10T11:18:21.0513164+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-b1l","depends_on_id":"chatbot-k5b","type":"blocks","created_at":"2026-02-10T11:18:21.0564972+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-bdw","title":"Create document preview and download UI","description":"Build UI for previewing and downloading generated documents","design":"Create frontend/src/components/document/DocumentPreview.tsx. Show generation status, preview (PDF embed or DOCX info), download button. Require disclaimer acknowledgment before download. Show generated documents list for user.","acceptance_criteria":"Generation status shows progress, preview works for PDF, download triggers file save, disclaimer required before download","status":"closed","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:27:31.5965338+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:27:00.553564+07:00","closed_at":"2026-02-05T14:27:00.553564+07:00","close_reason":"Document preview and download UI created at frontend/src/app/documents/[id]/page.tsx. Shows document details, variables used, download button, and finalize action.","labels":["component:frontend","phase:us5","spec:001-planning","story:US5"],"dependencies":[{"issue_id":"chatbot-bdw","depends_on_id":"chatbot-1qr","type":"parent-child","created_at":"2026-02-04T16:27:31.6050136+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-bdw","depends_on_id":"chatbot-cgb","type":"blocks","created_at":"2026-02-04T16:27:31.6162145+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-bf8","title":"Implement Playwright-based web crawler","description":"Create crawler service using Playwright to fetch legal documents from thuvienphapluat.vn.","design":"Create legal_chatbot/services/crawler.py with CrawlerService class: async crawl() method using Playwright, navigate to thuvienphapluat.vn, extract document list, follow pagination. Implement rate limiting (2s between requests). Return CrawledDocument objects.","acceptance_criteria":"Crawler fetches documents from thuvienphapluat.vn. Rate limiting works. HTML content extracted.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:18:21.075549+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:18:21.075549+07:00","labels":["component:crawler","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-bf8","depends_on_id":"chatbot-8ir","type":"parent-child","created_at":"2026-02-05T15:18:21.0810428+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-bm8","title":"Create Template browser UI","description":"Build frontend UI for browsing and selecting document templates","design":"Create frontend/src/components/document/TemplateList.tsx, TemplateCard.tsx. Show templates by category (tabs or filter). Each card: template name, category badge, required fields count. Click to select for generation.","acceptance_criteria":"Templates display by category, cards show key info, selection navigates to generation form","status":"closed","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:26:38.356746+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:19:09.2690155+07:00","closed_at":"2026-02-05T14:19:09.2690155+07:00","close_reason":"Template browser UI created: TemplateCard, TemplateList, TemplateForm components at frontend/src/components/templates/. Templates page at frontend/src/app/templates/page.tsx with category filter and search.","labels":["component:frontend","phase:us4","spec:001-planning","story:US4"],"dependencies":[{"issue_id":"chatbot-bm8","depends_on_id":"chatbot-pul","type":"parent-child","created_at":"2026-02-04T16:26:38.3657996+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-bm8","depends_on_id":"chatbot-5h5","type":"blocks","created_at":"2026-02-04T16:26:38.3756317+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-bnf","title":"Setup OpenTelemetry metrics and tracing","description":"Configure OpenTelemetry for metrics collection and distributed tracing","design":"Create backend/src/lib/telemetry.ts. Install @opentelemetry/* packages. Configure: HTTP instrumentation, Pino instrumentation, Prometheus exporter. Track: http_requests, http_duration, llm_tokens, llm_latency. Add /metrics endpoint.","acceptance_criteria":"Metrics exposed on /metrics, traces connected to logs via correlation ID, Prometheus can scrape metrics","status":"closed","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:27:49.0077223+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:29:08.1356405+07:00","closed_at":"2026-02-05T14:29:08.1356405+07:00","close_reason":"OpenTelemetry metrics and tracing setup at backend/src/lib/telemetry/index.ts. Includes: OTLP exporters, auto-instrumentation, custom metrics for LLM/search/documents.","labels":["component:observability","phase:polish","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-bnf","depends_on_id":"chatbot-rts","type":"parent-child","created_at":"2026-02-04T16:27:49.0120327+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-bxd","title":"Implement template loader and validator","description":"Load and validate contract templates from JSON files.","design":"Create legal_chatbot/services/generator.py with: list_templates() to enumerate available templates, get_template() to load specific template as ContractTemplate model, validate_data() to check input against required fields and validation patterns.","acceptance_criteria":"Templates loaded from JSON. Validation catches missing/invalid fields. Clear error messages.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:20:58.101863+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:20:58.101863+07:00","labels":["component:generator","phase:us4","spec:001-planning","story:US4"],"dependencies":[{"issue_id":"chatbot-bxd","depends_on_id":"chatbot-3z4","type":"parent-child","created_at":"2026-02-05T15:20:58.1055489+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-bzv","title":"Legal Chatbot","description":"Python CLI chatbot for legal consultation with RAG-based Q\u0026A and PDF contract generation. Crawls Vietnamese legal documents, indexes into SQLite+ChromaDB, answers questions using Groq LLM with citations, and generates PDF contracts from templates.","status":"open","priority":1,"issue_type":"epic","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:16:10.8206974+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:16:10.8206974+07:00","labels":["component:chat","component:cli","component:crawler","component:generator","component:indexer","spec:001-planning"]}
{"id":"chatbot-c2s","title":"Implement article extraction from HTML","description":"Extract individual articles (Điều) from legal document HTML content.","design":"Create legal_chatbot/services/indexer.py with parse_articles() method: use regex to find Điều patterns, extract article_number, title, content. Split document into Article objects. Handle nested Khoản/Điểm structure.","acceptance_criteria":"Articles extracted with correct numbers and content. Chapter references preserved.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:19:05.8201278+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:19:05.8201278+07:00","labels":["component:indexer","phase:us2","spec:001-planning","story:US2"],"dependencies":[{"issue_id":"chatbot-c2s","depends_on_id":"chatbot-hy0","type":"parent-child","created_at":"2026-02-05T15:19:05.8237498+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-cda","title":"Add CLI init command for database setup","description":"Add init command to CLI for initializing database and ChromaDB.","design":"Add legal_chatbot/cli/init.py with init command that calls db.sqlite.init_db() and db.chroma.init_chroma(). Create data/ directory if not exists.","acceptance_criteria":"python -m legal_chatbot init creates database file and ChromaDB directory. Prints success message.","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:17:54.1670955+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:17:54.1670955+07:00","labels":["component:cli","phase:foundational","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-cda","depends_on_id":"chatbot-t2s","type":"parent-child","created_at":"2026-02-05T15:17:54.1702719+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-cgb","title":"Create document generation form UI","description":"Build frontend form for filling template variables and generating documents","design":"Create frontend/src/components/document/GenerationForm.tsx. Dynamically render fields from template.requiredFields. Support types: string (input), number (input type=number), date (date picker). Show validation errors. Format selector (PDF/DOCX). Submit to generate API.","acceptance_criteria":"Form renders required fields dynamically, validation errors display, format selection works, submission triggers generation","status":"closed","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:27:24.3839764+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:26:55.5836154+07:00","closed_at":"2026-02-05T14:26:55.5836154+07:00","close_reason":"Document generation form UI implemented in TemplateForm component at frontend/src/components/templates/TemplateForm.tsx. Handles required/optional fields, validation, format selection.","labels":["component:frontend","phase:us5","spec:001-planning","story:US5"],"dependencies":[{"issue_id":"chatbot-cgb","depends_on_id":"chatbot-1qr","type":"parent-child","created_at":"2026-02-04T16:27:24.4236986+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-cgb","depends_on_id":"chatbot-bm8","type":"blocks","created_at":"2026-02-04T16:27:24.4341671+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-cgb","depends_on_id":"chatbot-q9i","type":"blocks","created_at":"2026-02-04T16:27:24.4443552+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-cut","title":"Implement SupabaseClient","description":"Implement Supabase database client with CRUD, RPC vector search, and Storage operations","design":"Create legal_chatbot/db/supabase.py. Implement SupabaseClient(DatabaseInterface). Use singleton pattern (@lru_cache). Init with create_client(url, key, ClientOptions). Implement all CRUD via supabase.table().insert/select/update/upsert.execute(). Implement search_articles via supabase.rpc('match_articles', {query_embedding, match_threshold, match_count, filter_status}). Add upload_raw_document(path, bytes, mime) and download_raw_document(path) for Storage. Use service_role key for writes, anon key for reads. Error handling: catch postgrest.exceptions.APIError. See contracts/supabase-client.md and research.md section 1.","acceptance_criteria":"SupabaseClient connects to Supabase. insert_document + get_document roundtrip works. search_articles calls RPC function. upload_raw_document saves to Storage bucket.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:11:54.3748752+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:11:54.3748752+07:00","labels":["component:db","spec:002-connect-db","story:US1"],"dependencies":[{"issue_id":"chatbot-cut","depends_on_id":"chatbot-3mo","type":"parent-child","created_at":"2026-02-10T11:11:54.3769638+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-cut","depends_on_id":"chatbot-42t","type":"blocks","created_at":"2026-02-10T11:11:54.3800434+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-cut","depends_on_id":"chatbot-3la","type":"blocks","created_at":"2026-02-10T11:11:54.3831247+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-d59","title":"Add crawl CLI command","description":"Implement CLI command for crawling legal documents.","design":"Create legal_chatbot/cli/crawl.py with: crawl command accepting --source (default thuvienphapluat), --limit (default 10), --category (optional). Call CrawlerService.crawl(). Save raw HTML to data/raw/. Print progress with Rich.","acceptance_criteria":"python -m legal_chatbot crawl --limit 5 fetches 5 documents. Files saved to data/raw/. Progress shown.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:18:33.5342999+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:18:33.5342999+07:00","labels":["component:cli","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-d59","depends_on_id":"chatbot-8ir","type":"parent-child","created_at":"2026-02-05T15:18:33.5378874+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-dab","title":"Implement semantic search service","description":"Create knowledge retrieval service with hybrid semantic + keyword search","design":"Create backend/src/services/knowledge/search.service.ts. Methods: semanticSearch(query, filters, topK), hybridSearch(query, filters). Use pgvector cosine similarity. Combine with PostgreSQL full-text search (ts_rank). Rerank with combined score (0.6 semantic + 0.4 lexical).","acceptance_criteria":"Semantic search returns relevant chunks, hybrid search improves recall, filters by category/status work, relevance scores correct","status":"closed","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:25:17.772767+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:16:31.7900821+07:00","closed_at":"2026-02-05T14:16:31.7900821+07:00","close_reason":"Semantic search service created at backend/src/services/knowledge/search.service.ts. Implements pgvector similarity search, related documents, and stats.","labels":["component:backend","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-dab","depends_on_id":"chatbot-lu8","type":"parent-child","created_at":"2026-02-04T16:25:17.7800961+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-day","title":"Phase 7: Polish and Integration","description":"Final phase: Cross-cutting concerns, integration testing, performance optimization, and documentation.","status":"open","priority":2,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:21:35.6858777+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:21:35.6858777+07:00","labels":["component:infra","phase:polish","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-day","depends_on_id":"chatbot-bzv","type":"parent-child","created_at":"2026-02-05T15:21:35.690204+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-db6","title":"Integrate audit into GeneratorService","description":"Update services/generator.py: after generating PDF in generate(), create ContractAudit with contract_type, input_data, generated_content, legal_references, law_versions, pdf_storage_path. Call save_contract_audit(). Audit failure must NOT prevent generation from completing. Contract: contracts/audit.md integration section","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:18:48.7305322+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:18:48.7305322+07:00","labels":["component:services","file:services/generator.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-db6","depends_on_id":"chatbot-w4o","type":"parent-child","created_at":"2026-02-10T11:18:48.732609+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-dp9","title":"Extend indexer to use embedding service + Supabase","description":"Extend services/indexer.py: after parsing articles, call EmbeddingService.embed_and_store() to generate embeddings and upsert to Supabase. Parse Vietnamese legal hierarchy (Phan/Chuong/Muc/Dieu/Khoan/Diem). Depends on embed_and_store (chatbot-8ai) and SupabaseClient (chatbot-cut).","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:17:57.6699354+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:17:57.6699354+07:00","labels":["component:services","file:services/indexer.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-dp9","depends_on_id":"chatbot-4sx","type":"parent-child","created_at":"2026-02-10T11:17:57.6720072+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-dp9","depends_on_id":"chatbot-8ai","type":"blocks","created_at":"2026-02-10T11:17:57.6767865+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-dp9","depends_on_id":"chatbot-cut","type":"blocks","created_at":"2026-02-10T11:17:57.6810646+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-dt9","title":"Setup pytest configuration and test structure","description":"Configure pytest and create test directory structure.","design":"Add pytest config to pyproject.toml. Create tests/, tests/conftest.py with fixtures, tests/unit/, tests/contract/, tests/integration/ directories.","acceptance_criteria":"pytest runs successfully with no tests. Test discovery works.","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:17:01.9825724+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:17:01.9825724+07:00","labels":["component:infra","phase:setup","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-dt9","depends_on_id":"chatbot-rvm","type":"parent-child","created_at":"2026-02-05T15:17:01.9857798+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-dur","title":"Performance optimization for search","description":"Optimize search performance for larger knowledge bases.","design":"Profile search operations. Optimize ChromaDB queries (batch where possible). Cache frequently accessed articles. Add connection pooling for SQLite. Target: search response \u003c2s for 1000 articles.","acceptance_criteria":"Search performs within target. Memory usage reasonable. No degradation with scale.","status":"open","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:21:59.9448525+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:21:59.9448525+07:00","labels":["component:db","phase:polish","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-dur","depends_on_id":"chatbot-day","type":"parent-child","created_at":"2026-02-05T15:21:59.9479294+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-dwi","title":"Integrate document generation with chat context","description":"Allow document generation using context collected during chat session.","design":"In services/generator.py: add generate_from_session() that takes session_id, loads context from chat session, maps collected data to template fields, generates PDF with pre-filled values. In chat CLI, suggest document generation when template is recommended.","acceptance_criteria":"Chat context used to pre-fill contract. Missing fields prompted. Seamless flow from chat to document.","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:21:22.5799663+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:21:22.5799663+07:00","labels":["component:generator","phase:us4","spec:001-planning","story:US4"],"dependencies":[{"issue_id":"chatbot-dwi","depends_on_id":"chatbot-3z4","type":"parent-child","created_at":"2026-02-05T15:21:22.5841589+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-eb4","title":"Create API client service for frontend","description":"Create typed API client in frontend using fetch/axios with React Query integration","design":"Create frontend/src/services/api/. Files: client.ts (base fetch wrapper with auth), conversations.ts (conversation hooks), messages.ts (message hooks with streaming). Use @tanstack/react-query for caching. Handle JWT from localStorage.","acceptance_criteria":"All API methods typed correctly, React Query hooks work, streaming messages update UI progressively","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:23:56.2149126+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:01:49.2858826+07:00","closed_at":"2026-02-05T14:01:49.2858826+07:00","close_reason":"API client service implemented with full TypeScript types. Methods: auth (login/register/logout/me), conversations (CRUD), messages (send/stream SSE), knowledge (search/get), documents (templates/generate/validate). Token management with localStorage.","labels":["component:frontend","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-eb4","depends_on_id":"chatbot-fga","type":"parent-child","created_at":"2026-02-04T16:23:56.2203978+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-ek0","title":"Setup Express API routing structure","description":"Create API routing structure with middleware, error handling, and request validation","design":"Create backend/src/api/routes/. Setup: express Router for each tag in openapi.yaml (auth, conversations, messages, knowledge, documents). Add Zod validation middleware. Configure CORS, helmet, compression. Add request logging with Pino.","acceptance_criteria":"All route groups registered, validation errors return 400, auth middleware protects routes, request/response logged","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:22:58.944017+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T13:54:40.9059698+07:00","closed_at":"2026-02-05T13:54:40.9059698+07:00","close_reason":"Express API routing structure implemented. Routes: auth (login/register/me), conversations (CRUD), messages (send/stream), knowledge (search/get), documents (templates/generate/download/validate). Zod validation middleware, error handling, CORS, helmet security configured.","labels":["component:backend","phase:foundational","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-ek0","depends_on_id":"chatbot-9qs","type":"parent-child","created_at":"2026-02-04T16:22:58.9471567+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-ek0","depends_on_id":"chatbot-jlr","type":"blocks","created_at":"2026-02-04T16:22:58.9502539+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-eqm","title":"Implement document indexing pipeline","description":"Create indexing pipeline that stores documents in SQLite and vectors in ChromaDB.","design":"In services/indexer.py add index_document() method: parse document metadata, extract articles, generate embeddings, store in SQLite (legal_documents, articles tables), store vectors in ChromaDB (legal_articles collection). Return IndexResult with counts.","acceptance_criteria":"Documents stored in SQLite. Vectors stored in ChromaDB. Metadata preserved correctly.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:19:18.2359101+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:19:18.2359101+07:00","labels":["component:indexer","phase:us2","spec:001-planning","story:US2"],"dependencies":[{"issue_id":"chatbot-eqm","depends_on_id":"chatbot-hy0","type":"parent-child","created_at":"2026-02-05T15:19:18.2390006+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-fb1","title":"Create CLI entry point with Typer","description":"Create __main__.py and cli/main.py with Typer CLI application skeleton.","design":"Create legal_chatbot/__main__.py that imports and runs cli.main:app. Create legal_chatbot/cli/main.py with Typer app and stub commands: crawl, index, chat, generate, templates.","acceptance_criteria":"python -m legal_chatbot --help shows all commands. Each command has --help.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:16:49.5099821+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:16:49.5099821+07:00","labels":["component:cli","phase:setup","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-fb1","depends_on_id":"chatbot-rvm","type":"parent-child","created_at":"2026-02-05T15:16:49.5157147+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-fga","title":"Phase 3: US1 - Basic Chat Interface","description":"User Story 1 (P1 - MVP): Users can engage in conversations with the chatbot. Includes conversation CRUD, message sending/receiving, and basic chat UI. Independent Test: User can start a conversation, send a message, and receive an AI response.","status":"closed","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:21:03.1894262+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:09:16.6509657+07:00","closed_at":"2026-02-05T14:09:16.6509657+07:00","close_reason":"Phase 3: US1 - Basic Chat Interface complete. All 8 tasks done: Conversation/Message services with Prisma, API endpoints (CRUD + streaming), Chat UI components (ChatContainer, ChatMessage, ChatInput, CitationPanel), API client, legal disclaimer.","labels":["component:backend","component:frontend","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-fga","depends_on_id":"chatbot-4n3","type":"parent-child","created_at":"2026-02-04T16:21:03.1964408+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-fga","depends_on_id":"chatbot-9qs","type":"blocks","created_at":"2026-02-04T16:21:03.200911+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-g5f","title":"Create contract template JSON files","description":"Create JSON template files for common contract types.","design":"Create legal_chatbot/templates/ with rental.json, sale.json, service.json. Each template contains: id, type, name, description, fields array (name, label, field_type, required, validation), legal_references array, content_sections for PDF layout.","acceptance_criteria":"Templates load correctly. All required fields defined. Legal references included.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:20:52.0192661+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:20:52.0192661+07:00","labels":["component:generator","phase:us4","spec:001-planning","story:US4"],"dependencies":[{"issue_id":"chatbot-g5f","depends_on_id":"chatbot-3z4","type":"parent-child","created_at":"2026-02-05T15:20:52.0229163+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-g9u","title":"Validate quickstart.md workflow","description":"Verify all commands in quickstart.md work correctly.","design":"Follow quickstart.md step by step: setup venv, install deps, init db, crawl sample docs, index, chat query, generate document. Document any issues. Update quickstart.md if needed.","acceptance_criteria":"All quickstart commands work. New user can follow guide successfully.","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:22:06.0821197+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:22:06.0821197+07:00","labels":["component:docs","phase:polish","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-g9u","depends_on_id":"chatbot-day","type":"parent-child","created_at":"2026-02-05T15:22:06.0855521+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-gd2","title":"Implement AuditService","description":"Create services/audit.py with AuditService class. Methods: save_research_audit() and save_contract_audit() insert to DB and return audit ID. get_research_audit() and get_contract_audit() retrieve by ID. list_audits() returns combined list sorted by created_at desc. verify_audit() checks if law versions are still current against DB. build_law_versions() looks up parent documents for article IDs. Contract: contracts/audit.md","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:18:43.8632245+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:18:43.8632245+07:00","labels":["component:services","file:services/audit.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-gd2","depends_on_id":"chatbot-w4o","type":"parent-child","created_at":"2026-02-10T11:18:43.8652787+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-gd2","depends_on_id":"chatbot-cut","type":"blocks","created_at":"2026-02-10T11:18:43.8704272+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-gkd","title":"Add templates CLI command","description":"Implement CLI command to list available templates and their fields.","design":"Create legal_chatbot/cli/generate.py with: templates command to list all templates with Rich table, template command with --fields flag to show required fields for specific template.","acceptance_criteria":"python -m legal_chatbot templates lists all templates. template rental --fields shows all fields.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:21:10.3084893+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:21:10.3084893+07:00","labels":["component:cli","phase:us4","spec:001-planning","story:US4"],"dependencies":[{"issue_id":"chatbot-gkd","depends_on_id":"chatbot-3z4","type":"parent-child","created_at":"2026-02-05T15:21:10.3115717+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-hbt","title":"Unit tests for embedding service","description":"Create tests/unit/test_embedding.py. Tests: embed_single returns 768d, embed_batch preserves order despite length-sorting, NFC normalization verified, split_long_article produces correct chunks with headers, embed_and_store upserts to DB. Contract: contracts/embedding.md testing section","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:17:27.4635682+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:17:27.4635682+07:00","labels":["component:tests","file:tests/unit/test_embedding.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-hbt","depends_on_id":"chatbot-v0a","type":"parent-child","created_at":"2026-02-10T11:17:27.4656448+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-hxf","title":"Create embedding service for query vectors","description":"Create backend service to generate query embeddings using HuggingFace API","design":"Create backend/src/services/knowledge/embedding.service.ts. Use @huggingface/inference for BAAI/bge-large-vi. Cache frequently used queries. Normalize vectors. Handle Vietnamese text preprocessing.","acceptance_criteria":"Query embeddings generated correctly, caching reduces API calls, embeddings match crawler format","status":"closed","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:25:25.3764145+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:16:30.7657555+07:00","closed_at":"2026-02-05T14:16:30.7657555+07:00","close_reason":"Embedding service created at backend/src/services/knowledge/embedding.service.ts. Uses HuggingFace API with BAAI/bge-m3 model for 1024-dim embeddings.","labels":["component:backend","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-hxf","depends_on_id":"chatbot-lu8","type":"parent-child","created_at":"2026-02-04T16:25:25.3818089+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-hy0","title":"Phase 4: US2 - Knowledge Indexer","description":"User Story 2: As a legal admin, I want to index crawled documents into a searchable knowledge base so that the chatbot can retrieve relevant information. Goal: Process and index documents into SQLite+ChromaDB. Test: python -m legal_chatbot index --input ./data/raw indexes all documents.","status":"open","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:18:53.4280631+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:18:53.4280631+07:00","labels":["component:indexer","phase:us2","spec:001-planning","story:US2"],"dependencies":[{"issue_id":"chatbot-hy0","depends_on_id":"chatbot-bzv","type":"parent-child","created_at":"2026-02-05T15:18:53.4316623+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-hy0","depends_on_id":"chatbot-t2s","type":"blocks","created_at":"2026-02-05T15:22:35.8111519+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-ii0","title":"Create .env.example and config management","description":"Create environment configuration with .env.example and utils/config.py for loading settings.","design":"Create .env.example with GROQ_API_KEY, DATABASE_PATH, CHROMA_PATH, LOG_LEVEL. Create legal_chatbot/utils/config.py with pydantic Settings class loading from .env.","acceptance_criteria":"Config loads from .env file. Missing required vars raise clear error.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:16:55.8286624+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:16:55.8286624+07:00","labels":["component:infra","phase:setup","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-ii0","depends_on_id":"chatbot-rvm","type":"parent-child","created_at":"2026-02-05T15:16:55.8331294+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-jlr","title":"Implement JWT authentication middleware","description":"Create authentication system with JWT tokens, login/register endpoints, and auth middleware","design":"Create backend/src/services/auth/. Implement: hashPassword (bcrypt), generateToken (jsonwebtoken), verifyToken middleware. Create POST /auth/login, POST /auth/register, GET /auth/me endpoints per openapi.yaml.","acceptance_criteria":"Register creates user, login returns JWT, protected routes reject without valid token, /auth/me returns current user","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:22:50.708114+07:00","created_by":"Bao Lam","updated_at":"2026-02-04T18:03:01.6575197+07:00","closed_at":"2026-02-04T18:03:01.6575197+07:00","close_reason":"JWT authentication implemented: hashPassword (bcrypt 12 rounds), generateToken, verifyToken. authMiddleware for protected routes. optionalAuthMiddleware for optional auth. JWT_EXPIRY: 7 days.","labels":["component:auth","component:backend","phase:foundational","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-jlr","depends_on_id":"chatbot-9qs","type":"parent-child","created_at":"2026-02-04T16:22:50.7147179+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-jlr","depends_on_id":"chatbot-6w2","type":"blocks","created_at":"2026-02-04T16:22:50.7186501+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-jo3","title":"Create Chat UI components","description":"Build React chat interface components with conversation list and message area","design":"Create frontend/src/components/chat/. Components: ConversationList (sidebar), ChatWindow (main area), MessageBubble (user/assistant), MessageInput (text input + send). Use Tailwind for styling. Support Vietnamese text rendering.","acceptance_criteria":"Conversation list shows user conversations, clicking opens chat, messages display correctly, input sends messages","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:24:03.8404805+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:05:03.1896767+07:00","closed_at":"2026-02-05T14:05:03.1896767+07:00","close_reason":"Chat UI components implemented: ChatContainer (main chat view with streaming), ChatMessage (message bubble with citations), ChatInput (auto-resize textarea, Enter to send), CitationPanel (citation details sidebar). Full Vietnamese localization.","labels":["component:frontend","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-jo3","depends_on_id":"chatbot-fga","type":"parent-child","created_at":"2026-02-04T16:24:03.8464292+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-jo3","depends_on_id":"chatbot-eb4","type":"blocks","created_at":"2026-02-04T16:24:03.8518011+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-js4","title":"Implement chat session persistence","description":"Persist chat sessions and messages for context management.","design":"In services/chat.py: add session management using SQLite chat_sessions/chat_messages tables. Create new session on first message, store messages with citations, load history for follow-up questions, collect user context (e.g., property details) for document generation.","acceptance_criteria":"Sessions persisted across messages. History loaded correctly. Context accumulated.","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:20:26.9196909+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:20:26.9196909+07:00","labels":["component:chat","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-js4","depends_on_id":"chatbot-17y","type":"parent-child","created_at":"2026-02-05T15:20:26.9228113+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-k5b","title":"Implement PipelineService orchestrator","description":"Create services/pipeline.py with PipelineService class. Orchestrates 4 phases: discover() finds new/updated docs by comparing content_hash, crawl_document() fetches via stealth crawler + saves raw HTML to Supabase Storage, index_document() stores in DB + generates embeddings, validate() checks article count + embedding completeness. Logs run to pipeline_runs table. Contract: contracts/pipeline.md","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:17:51.9191833+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:17:51.9191833+07:00","labels":["component:services","file:services/pipeline.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-k5b","depends_on_id":"chatbot-4sx","type":"parent-child","created_at":"2026-02-10T11:17:51.921268+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-k5b","depends_on_id":"chatbot-cut","type":"blocks","created_at":"2026-02-10T11:17:51.9253821+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-k5b","depends_on_id":"chatbot-v0a","type":"blocks","created_at":"2026-02-10T11:17:51.9300692+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-kup","title":"Implement retry logic and error handling for crawler","description":"Add robust error handling and retry logic to crawler service.","design":"In services/crawler.py: add exponential backoff for failed requests (max 3 retries), handle network timeouts gracefully, log errors with context, skip problematic documents and continue crawling.","acceptance_criteria":"Crawler handles network errors without crashing. Retries work. Errors logged.","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:18:39.719735+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:18:39.719735+07:00","labels":["component:crawler","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-kup","depends_on_id":"chatbot-8ir","type":"parent-child","created_at":"2026-02-05T15:18:39.7252721+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-kzy","title":"Add pipeline CLI command group","description":"Add pipeline command group to CLI: 'pipeline crawl --category \u003cname\u003e --limit N' runs the full pipeline, 'pipeline status' shows last 5 runs, 'pipeline categories' lists available categories. Rich table output with progress phases. Contract: contracts/pipeline.md CLI section","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:18:00.6766694+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:18:00.6766694+07:00","labels":["component:cli","file:cli/main.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-kzy","depends_on_id":"chatbot-4sx","type":"parent-child","created_at":"2026-02-10T11:18:00.6788974+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-l8c","title":"Create SQL migration script","description":"Create SQL migration to setup all Supabase tables, indexes, RPC functions, and RLS policies","design":"Create legal_chatbot/db/migration.py with full SQL migration. Tables: legal_categories, legal_documents, articles (with VECTOR(768) + HNSW index), document_relations, pipeline_runs, research_audits, contract_audits, chat_sessions, chat_messages, contract_templates. RPC functions: match_articles, search_legal_articles. RLS policies: public read for legal data, service_role write for pipeline/audits. Enable pgvector extension. See data-model.md sections 1-6 for exact SQL.","acceptance_criteria":"Running migration creates all 9 tables. HNSW index on articles.embedding exists. match_articles RPC function callable. RLS policies active.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:12:04.0569974+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:12:04.0569974+07:00","labels":["component:db","spec:002-connect-db","story:US1"],"dependencies":[{"issue_id":"chatbot-l8c","depends_on_id":"chatbot-3mo","type":"parent-child","created_at":"2026-02-10T11:12:04.0590727+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-l8c","depends_on_id":"chatbot-pfr","type":"blocks","created_at":"2026-02-10T11:12:04.062688+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-lu8","title":"Phase 5: US3 - Knowledge Retrieval with Citations","description":"User Story 3 (P2): Users receive answers with accurate legal citations. Integrates RAG (LlamaIndex + LangChain), semantic search via pgvector, and citation tracking. Independent Test: User asks a legal question, system retrieves relevant chunks, and response includes citations with article numbers.","status":"closed","priority":2,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:21:17.7746626+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:17:05.380895+07:00","closed_at":"2026-02-05T14:17:05.380895+07:00","close_reason":"Phase 5: US3 - Knowledge Retrieval complete. All 7 tasks done: embedding service, semantic search, citation service, RAG pipeline, knowledge API, message service integration, citation UI.","labels":["component:backend","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-lu8","depends_on_id":"chatbot-4n3","type":"parent-child","created_at":"2026-02-04T16:21:17.7812879+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-lu8","depends_on_id":"chatbot-fga","type":"blocks","created_at":"2026-02-04T16:21:17.7847015+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-lu8","depends_on_id":"chatbot-206","type":"blocks","created_at":"2026-02-04T16:21:17.7885236+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-lwh","title":"Implement EmbeddingService core","description":"Create services/embedding.py with EmbeddingService class. Lazy-load bkai-foundation-models/vietnamese-bi-encoder (768d, ~1.1GB). Methods: get_model() singleton, embed_single() with NFC normalize + encode, embed_batch() with length-sorting for throughput. Use normalize_embeddings=True. Contract: contracts/embedding.md","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:17:23.033876+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:17:23.033876+07:00","labels":["component:services","file:services/embedding.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-lwh","depends_on_id":"chatbot-v0a","type":"parent-child","created_at":"2026-02-10T11:17:23.0359734+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-m2e","title":"Create models/pipeline.py","description":"Create models/pipeline.py with Pydantic models: PipelineRun (id, category, status, phases, stats, timestamps), PipelineStatus enum (RUNNING/COMPLETED/FAILED), CrawlResult (url, title, document_number, content_hash, html, articles, is_new), CategoryConfig (name, display_name, crawl_url, document_urls, max_pages, rate_limit_seconds). Contract: contracts/pipeline.md","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:17:44.3913197+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:17:44.3913197+07:00","labels":["component:models","file:models/pipeline.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-m2e","depends_on_id":"chatbot-4sx","type":"parent-child","created_at":"2026-02-10T11:17:44.3956864+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-m2e","depends_on_id":"chatbot-pfr","type":"blocks","created_at":"2026-02-10T11:17:44.4002788+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-m3x","title":"Connect DB \u0026 Design Data Pipeline","description":"Extend Legal Chatbot with Supabase (PostgreSQL + pgvector), automated data pipeline for Vietnamese legal documents, and audit trail. Test case: crawl Luat Dat dai 2024. See specs/002-connect-db-and-design-data-pipeline/","status":"open","priority":1,"issue_type":"epic","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:10:34.7508226+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:10:34.7508226+07:00","labels":["component:db","component:embedding","component:pipeline","spec:002-connect-db"]}
{"id":"chatbot-mbp","title":"Add CLI db command group","description":"Add db migrate, db status, db sync CLI commands","design":"Edit legal_chatbot/cli/main.py. Add Typer sub-app 'db' with commands: migrate (run migration.py against Supabase), status (show connection info + table counts), sync (sync local SQLite to/from Supabase). Use Rich tables for formatted output. See spec section 2.4 and quickstart.md.","acceptance_criteria":"'python -m legal_chatbot db migrate' runs migration. 'python -m legal_chatbot db status' shows connection info and counts.","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:12:11.9687974+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:12:11.9687974+07:00","labels":["component:cli","spec:002-connect-db","story:US1"],"dependencies":[{"issue_id":"chatbot-mbp","depends_on_id":"chatbot-3mo","type":"parent-child","created_at":"2026-02-10T11:12:11.9708764+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-mbp","depends_on_id":"chatbot-cut","type":"blocks","created_at":"2026-02-10T11:12:11.9744836+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-mbp","depends_on_id":"chatbot-l8c","type":"blocks","created_at":"2026-02-10T11:12:11.9780906+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-nav","title":"Add error handling and user-friendly messages","description":"Improve error handling with clear, user-friendly error messages.","design":"Review all CLI commands for error cases. Add Rich formatting for errors. Include suggestions for common issues (API key missing, no indexed documents, etc.). Catch and handle all exceptions gracefully.","acceptance_criteria":"Errors show clear messages. Suggestions provided. No raw tracebacks for users.","status":"open","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:22:12.2122615+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:22:12.2122615+07:00","labels":["component:cli","phase:polish","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-nav","depends_on_id":"chatbot-day","type":"parent-child","created_at":"2026-02-05T15:22:12.2154208+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-nl9","title":"Implement vector embedding with bge-large-vi","description":"Create embedding service using BAAI/bge-large-vi model for Vietnamese text","design":"Create crawler/src/indexers/embedder.py. Use sentence-transformers or HuggingFace API for BAAI/bge-large-vi (1024 dims). Normalize vectors to unit length. Batch processing for efficiency. Handle Vietnamese text preprocessing (NFD normalization).","acceptance_criteria":"Embeddings generated for chunks, 1024 dimensions, normalized to unit length, batch processing works","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:24:53.2015432+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:08:54.7638021+07:00","closed_at":"2026-02-05T14:08:54.7638021+07:00","close_reason":"Vector embedding service implemented with sentence-transformers. Features: local model loading, HuggingFace API fallback, BAAI/bge-m3 default model, async/sync embedding, batch processing, cosine similarity calculation.","labels":["component:crawler","phase:us2","spec:001-planning","story:US2"],"dependencies":[{"issue_id":"chatbot-nl9","depends_on_id":"chatbot-206","type":"parent-child","created_at":"2026-02-04T16:24:53.2070157+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-nl9","depends_on_id":"chatbot-1j3","type":"blocks","created_at":"2026-02-04T16:24:53.2144421+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-osi","title":"Add legal disclaimer banner to chat","description":"Add required legal disclaimer UI that appears before chat and on each response","design":"Create frontend/src/components/chat/Disclaimer.tsx. Show modal on first app load with acknowledge button. Show compact banner above each assistant message. Text from research.md Section 4 (Vietnamese + English).","acceptance_criteria":"Disclaimer modal appears on first visit, acknowledgment persisted in localStorage, compact disclaimer on each response","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:24:19.207231+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:08:52.8268592+07:00","closed_at":"2026-02-05T14:08:52.8268592+07:00","close_reason":"Legal disclaimer components implemented: LegalDisclaimer (banner/inline/modal variants), DisclaimerFooter. Vietnamese content with important legal notices. Dismissible banner, accept modal option.","labels":["component:frontend","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-osi","depends_on_id":"chatbot-fga","type":"parent-child","created_at":"2026-02-04T16:24:19.2131216+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-osi","depends_on_id":"chatbot-91o","type":"blocks","created_at":"2026-02-04T16:24:19.2186432+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-pfr","title":"Extend Pydantic models for new schema","description":"Extend document models and add new pipeline/audit models for Supabase schema","design":"1) Edit legal_chatbot/models/document.py: Add DocumentStatus.EXPIRED, RelationType enum, LegalCategory model, extend LegalDocument (category_id, expiry_date, replaces_document_id, amended_by_document_id, metadata dict, content_hash, raw_storage_path), extend Article (section, part, embedding list[float], content_hash, chunk_index). Add DocumentRelation, ArticleWithContext (similarity field). 2) Create legal_chatbot/models/pipeline.py: PipelineStatus enum, CategoryConfig, CrawlResult, PipelineRun. 3) Create legal_chatbot/models/audit.py: LawVersion, ArticleSource, ResearchAudit, ContractAudit. See data-model.md sections 4.1-4.3.","acceptance_criteria":"All models importable. LegalDocument has content_hash field. Article has embedding Optional[List[float]]. PipelineRun and ResearchAudit models exist with correct fields.","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:11:32.9025871+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:34:02.9485319+07:00","closed_at":"2026-02-10T11:34:02.9485319+07:00","close_reason":"Extended document.py models, created pipeline.py and audit.py, updated __init__.py exports","labels":["component:models","spec:002-connect-db","story:US1"],"dependencies":[{"issue_id":"chatbot-pfr","depends_on_id":"chatbot-3mo","type":"parent-child","created_at":"2026-02-10T11:11:32.920748+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-pul","title":"Phase 6: US4 - Document Templates","description":"User Story 4 (P2): Users can browse and select legal document templates. Includes template CRUD, required fields schema, and template listing UI. Independent Test: User can list templates by category, view template details, and see required fields.","status":"closed","priority":2,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:21:26.2301749+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:19:14.6212737+07:00","closed_at":"2026-02-05T14:19:14.6212737+07:00","close_reason":"Phase 6: US4 - Document Templates complete. All 4 tasks done: DocumentTemplate service, Template API endpoints, initial contract templates, Template browser UI.","labels":["component:backend","component:frontend","phase:us4","spec:001-planning","story:US4"],"dependencies":[{"issue_id":"chatbot-pul","depends_on_id":"chatbot-4n3","type":"parent-child","created_at":"2026-02-04T16:21:26.2363959+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-pul","depends_on_id":"chatbot-9qs","type":"blocks","created_at":"2026-02-04T16:21:26.2420588+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-q9i","title":"Create Document generation API endpoints","description":"Implement REST endpoints for document generation per openapi.yaml","design":"Create backend/src/api/routes/documents.ts. Endpoints: POST /documents/generate, POST /documents/validate, GET /documents/:id, GET /documents/:id/download. Validate input with Zod. Stream file download with correct content-type.","acceptance_criteria":"Generate endpoint creates document, validate returns errors, download returns file with correct mime type","status":"closed","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:27:16.0262953+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:26:46.8318233+07:00","closed_at":"2026-02-05T14:26:46.8318233+07:00","close_reason":"Document generation API endpoints implemented at backend/src/api/routes/documents.ts. Routes: POST /generate, GET /documents, GET /:id, GET /:id/download, POST /:id/finalize, POST /validate.","labels":["component:backend","phase:us5","spec:001-planning","story:US5"],"dependencies":[{"issue_id":"chatbot-q9i","depends_on_id":"chatbot-1qr","type":"parent-child","created_at":"2026-02-04T16:27:16.0299861+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-q9i","depends_on_id":"chatbot-71v","type":"blocks","created_at":"2026-02-04T16:27:16.0386612+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-r5c","title":"Build crawler CLI with crawl and index commands","description":"Create CLI interface for running crawl and indexing operations","design":"Create crawler/src/cli/main.py using Click. Commands: crawl (--source, --limit, --category), index (--batch-size), check-updates (--since). Add progress bars, logging. Support dry-run mode.","acceptance_criteria":"CLI shows help, crawl fetches and stores documents, index processes chunks, check-updates detects changes","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:25:08.5283413+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:12:02.5514365+07:00","closed_at":"2026-02-05T14:12:02.5514365+07:00","close_reason":"Crawler CLI implemented. Commands: crawl (with --index flag), index (batch from files), search (vector similarity), stats, check-updates.","labels":["component:crawler","phase:us2","spec:001-planning","story:US2"],"dependencies":[{"issue_id":"chatbot-r5c","depends_on_id":"chatbot-206","type":"parent-child","created_at":"2026-02-04T16:25:08.5316032+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-r5c","depends_on_id":"chatbot-0re","type":"blocks","created_at":"2026-02-04T16:25:08.538434+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-rts","title":"Phase 8: Polish and Cross-Cutting","description":"Final phase for cross-cutting improvements: performance optimization, security hardening, observability setup (Pino, OpenTelemetry, Langfuse), documentation, and production readiness.","status":"closed","priority":3,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:21:39.9109857+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:30:24.2585529+07:00","closed_at":"2026-02-05T14:30:24.2585529+07:00","close_reason":"Phase 8: Polish and Cross-Cutting complete. All 5 tasks done: Docker Compose, rate limiting/security headers, OpenTelemetry, Langfuse, quickstart validation.","labels":["component:infra","phase:polish","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-rts","depends_on_id":"chatbot-4n3","type":"parent-child","created_at":"2026-02-04T16:21:39.9171978+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-rts","depends_on_id":"chatbot-lu8","type":"blocks","created_at":"2026-02-04T16:21:39.9211703+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-rts","depends_on_id":"chatbot-1qr","type":"blocks","created_at":"2026-02-04T16:21:39.9261023+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-rvm","title":"Phase 1: Setup","description":"Project initialization and development environment setup. Create Python package structure, install dependencies, configure tooling.","status":"open","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:16:24.1974961+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:16:24.1974961+07:00","labels":["component:infra","phase:setup","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-rvm","depends_on_id":"chatbot-bzv","type":"parent-child","created_at":"2026-02-05T15:16:24.2005733+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-sdk","title":"Implement services/scheduler.py (optional)","description":"Create services/scheduler.py using APScheduler. Schedule pipeline runs by category at configurable intervals (default: weekly via PIPELINE_CRAWL_INTERVAL=168 hours). Manual trigger takes priority. Optional feature - manual pipeline crawl works without this.","status":"open","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:19:09.8903995+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:19:09.8903995+07:00","labels":["component:services","file:services/scheduler.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-sdk","depends_on_id":"chatbot-shq","type":"parent-child","created_at":"2026-02-10T11:19:09.8925229+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-sdk","depends_on_id":"chatbot-k5b","type":"blocks","created_at":"2026-02-10T11:19:09.8990244+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-shq","title":"US6: Integration \u0026 Polish","description":"Final integration: optional scheduled pipeline runs via APScheduler, end-to-end testing (crawl -\u003e index -\u003e chat -\u003e audit), update all dependencies and documentation. Depends on Land Law Test Case (US4) and Audit Trail (US5).","status":"open","priority":2,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:19:02.9909545+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:19:02.9909545+07:00","labels":["phase:integration","spec:002-connect-db","story:US6"],"dependencies":[{"issue_id":"chatbot-shq","depends_on_id":"chatbot-m3x","type":"parent-child","created_at":"2026-02-10T11:19:02.9930064+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-shq","depends_on_id":"chatbot-1xb","type":"blocks","created_at":"2026-02-10T11:19:02.999193+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-shq","depends_on_id":"chatbot-w4o","type":"blocks","created_at":"2026-02-10T11:19:03.0053637+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-sx3","title":"Setup shared TypeScript types","description":"Create shared TypeScript types in shared/types/ that both frontend and backend can use","design":"Create shared/types/index.ts. Export types for: User, Conversation, Message, Citation, LegalDocument, DocumentTemplate, GeneratedDocument, API responses. Use Zod schemas for runtime validation. Configure package.json for local linking.","acceptance_criteria":"Types importable in both backend and frontend, Zod schemas validate correctly, no type errors","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:23:14.6731213+07:00","created_by":"Bao Lam","updated_at":"2026-02-04T18:03:00.1984798+07:00","closed_at":"2026-02-04T18:03:00.1984798+07:00","close_reason":"Shared TypeScript types created with Zod schemas. Includes: User, Auth, Conversation, Message, Citation, LegalDocument, DocumentTemplate, GeneratedDocument types. API response types with pagination. Package configured for local linking.","labels":["component:shared","phase:foundational","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-sx3","depends_on_id":"chatbot-9qs","type":"parent-child","created_at":"2026-02-04T16:23:14.6768278+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-sx3","depends_on_id":"chatbot-6w2","type":"blocks","created_at":"2026-02-04T16:23:14.7115513+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-t2s","title":"Phase 2: Foundational Data Layer","description":"Core data infrastructure that MUST complete before user stories. SQLite schema, ChromaDB setup, Pydantic models.","status":"open","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:17:16.0745201+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:17:16.0745201+07:00","labels":["component:db","phase:foundational","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-t2s","depends_on_id":"chatbot-bzv","type":"parent-child","created_at":"2026-02-05T15:17:16.0781587+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-t2s","depends_on_id":"chatbot-rvm","type":"blocks","created_at":"2026-02-05T15:22:23.7027938+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-tms","title":"Create Message API endpoints with streaming","description":"Implement REST endpoints for message sending with SSE streaming support","design":"Create backend/src/api/routes/messages.ts. Endpoints: GET /conversations/:id/messages (list), POST /conversations/:id/messages (send and get response), POST /conversations/:id/messages/stream (SSE streaming). Stream events: chunk, citations, done.","acceptance_criteria":"Messages returned with pagination, send returns user + assistant messages, streaming sends chunks as SSE events","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:23:47.9725469+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:06:54.1237617+07:00","closed_at":"2026-02-05T14:06:54.1237617+07:00","close_reason":"Message API endpoints with streaming implemented. GET /messages (paginated with cursor), POST /messages (sync send), POST /messages/stream (SSE streaming). Uses MessageService with Claude API. Proper error handling for stream errors.","labels":["component:backend","phase:us1","spec:001-planning","story:US1"],"dependencies":[{"issue_id":"chatbot-tms","depends_on_id":"chatbot-fga","type":"parent-child","created_at":"2026-02-04T16:23:47.9783482+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-tms","depends_on_id":"chatbot-7rn","type":"blocks","created_at":"2026-02-04T16:23:47.9826875+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-tms","depends_on_id":"chatbot-0d2","type":"blocks","created_at":"2026-02-04T16:23:47.9869138+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-tmz","title":"Implement RAG context builder","description":"Build RAG context from retrieved articles for LLM prompt.","design":"In services/chat.py add build_context() method: take query, call indexer search(), format articles with citations into context string, respect max_context_tokens limit (4000), include document titles and article numbers for citation.","acceptance_criteria":"Context built from search results. Token limit respected. Citations included.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:20:02.2767119+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:20:02.2767119+07:00","labels":["component:chat","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-tmz","depends_on_id":"chatbot-17y","type":"parent-child","created_at":"2026-02-05T15:20:02.2803118+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-ttd","title":"Implement SQLite database operations","description":"Create SQLite database module with schema creation and CRUD operations.","design":"Create legal_chatbot/db/sqlite.py with: init_db() to create tables per data-model.md, CRUD functions for legal_documents, articles, contract_templates, chat_sessions, chat_messages. Use context manager for connections.","acceptance_criteria":"Database file created on init. All CRUD operations work. Tables match data-model.md schema.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:17:35.6718782+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:17:35.6718782+07:00","labels":["component:db","phase:foundational","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-ttd","depends_on_id":"chatbot-t2s","type":"parent-child","created_at":"2026-02-05T15:17:35.6750109+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-tzw","title":"Add chat CLI command","description":"Implement CLI command for chatting with the legal assistant.","design":"Create legal_chatbot/cli/chat.py with: chat command accepting query as argument, --json flag for JSON output, --interactive flag for multi-turn chat. Format response with Rich: answer in panel, citations in list, suggestions as callout. Handle Ctrl+C gracefully in interactive mode.","acceptance_criteria":"python -m legal_chatbot chat 'query' shows formatted response. JSON output works. Interactive mode allows follow-ups.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:20:20.7147108+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:20:20.7147108+07:00","labels":["component:cli","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-tzw","depends_on_id":"chatbot-17y","type":"parent-child","created_at":"2026-02-05T15:20:20.7198122+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-u3m","title":"Create Citation service for tracking references","description":"Implement citation tracking to link messages to legal document chunks","design":"Create backend/src/services/knowledge/citation.service.ts. Methods: createCitations(messageId, chunks), findByMessage(messageId). Store: chunk_id, article_number, excerpt, relevance_score. Format citations for display (document title, article, excerpt).","acceptance_criteria":"Citations created when RAG used, citations link to correct chunks, citation display format correct","status":"closed","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:25:41.8323753+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:16:46.2305637+07:00","closed_at":"2026-02-05T14:16:46.2305637+07:00","close_reason":"Citation service created at backend/src/services/knowledge/citation.service.ts. Tracks references per message, formats citations for responses.","labels":["component:backend","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-u3m","depends_on_id":"chatbot-lu8","type":"parent-child","created_at":"2026-02-04T16:25:41.8377523+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-u3m","depends_on_id":"chatbot-9qr","type":"blocks","created_at":"2026-02-04T16:25:41.846121+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-ua0","title":"Extend crawler with Playwright stealth + Cloudflare bypass","description":"Extend services/crawler.py with: crawl_with_stealth() using Playwright + Firefox + playwright-stealth plugin, realistic viewport 1920x1080, locale vi-VN, wait for Cloudflare challenge 5-10s, rate limiting 3-5s + random jitter. crawl_category_listing() to discover documents from listing pages. compute_content_hash() SHA-256 for change detection. Contract: contracts/pipeline.md","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:17:48.1167968+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:17:48.1167968+07:00","labels":["component:services","file:services/crawler.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-ua0","depends_on_id":"chatbot-4sx","type":"parent-child","created_at":"2026-02-10T11:17:48.1188518+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-ut0","title":"Create Docker Compose for local development","description":"Create Docker Compose configuration for running all services locally","design":"Create docker-compose.yml with: postgres (pgvector), backend (Node.js), frontend (Next.js). Add volumes for persistent data. Configure networking. Add docker-compose.override.yml for development settings.","acceptance_criteria":"docker-compose up starts all services, database persists, hot reload works for dev, all services communicate","status":"closed","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:28:13.4821313+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:29:05.2113791+07:00","closed_at":"2026-02-05T14:29:05.2113791+07:00","close_reason":"Docker Compose for local development expanded at docker-compose.yml. Includes: PostgreSQL with pgvector, backend API, frontend Next.js, and crawler service.","labels":["component:infra","phase:polish","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-ut0","depends_on_id":"chatbot-rts","type":"parent-child","created_at":"2026-02-04T16:28:13.4876374+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-uvu","title":"Final dependency and documentation updates","description":"Final pass: verify requirements.txt has all new deps (supabase\u003e=2.0.0, sentence-transformers\u003e=2.2.0, playwright-stealth\u003e=1.0.0, apscheduler\u003e=3.10.0), verify .env.example has all new vars, update CLAUDE.md if needed.","status":"open","priority":3,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:19:20.046452+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:19:20.046452+07:00","labels":["component:docs","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-uvu","depends_on_id":"chatbot-shq","type":"parent-child","created_at":"2026-02-10T11:19:20.0483828+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-v0a","title":"US2: Embedding Service","description":"Generate Vietnamese legal text embeddings using bkai-foundation-models/vietnamese-bi-encoder (768d) with NFC normalization and pgvector storage","status":"open","priority":1,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:12:19.3887111+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:12:19.3887111+07:00","labels":["component:embedding","phase:foundational","spec:002-connect-db","story:US2"],"dependencies":[{"issue_id":"chatbot-v0a","depends_on_id":"chatbot-m3x","type":"parent-child","created_at":"2026-02-10T11:12:19.3907675+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-v0a","depends_on_id":"chatbot-3mo","type":"blocks","created_at":"2026-02-10T11:12:19.3943715+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-v7e","title":"Update ChatService to query Supabase for RAG","description":"Update services/chat.py to use DatabaseInterface for RAG pipeline. When DB_MODE=supabase: embed query via EmbeddingService, call search_articles() RPC for semantic search, use results as context for LLM. Preserve existing ChromaDB path as fallback when DB_MODE=sqlite.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:19:16.853757+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:19:16.853757+07:00","labels":["component:services","file:services/chat.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-v7e","depends_on_id":"chatbot-shq","type":"parent-child","created_at":"2026-02-10T11:19:16.8558556+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-v7e","depends_on_id":"chatbot-cut","type":"blocks","created_at":"2026-02-10T11:19:16.8623219+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-v7e","depends_on_id":"chatbot-v0a","type":"blocks","created_at":"2026-02-10T11:19:16.8694186+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-v7m","title":"Test semantic search with land law queries","description":"Test semantic search with Vietnamese land law queries: 'Dieu kien chuyen nhuong quyen su dung dat?', 'Thu tuc cap giay chung nhan quyen su dung dat'. Verify results cite Luat Dat dai 2024 with specific article numbers. Verify similarity \u003e 0.5. Update chat service to query Supabase when DB_MODE=supabase.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:18:25.1553118+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:18:25.1553118+07:00","labels":["component:search","spec:002-connect-db","story:US4"],"dependencies":[{"issue_id":"chatbot-v7m","depends_on_id":"chatbot-1xb","type":"parent-child","created_at":"2026-02-10T11:18:25.1580414+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-vhq","title":"End-to-end integration test","description":"Create tests/integration/test_pipeline_e2e.py. Full flow: crawl dat-dai category -\u003e verify articles indexed -\u003e run chat query -\u003e verify audit trail saved -\u003e verify law versions in audit are current. Also test DB mode switching (supabase vs sqlite). Depends on pipeline run (chatbot-b1l) and AuditService (chatbot-gd2).","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:19:13.3093242+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:19:13.3093242+07:00","labels":["component:tests","file:tests/integration/test_pipeline_e2e.py","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-vhq","depends_on_id":"chatbot-shq","type":"parent-child","created_at":"2026-02-10T11:19:13.31145+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-vhq","depends_on_id":"chatbot-b1l","type":"blocks","created_at":"2026-02-10T11:19:13.3181686+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-vhq","depends_on_id":"chatbot-gd2","type":"blocks","created_at":"2026-02-10T11:19:13.3243883+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-w4o","title":"US5: Audit Trail","description":"Record research results and generated contracts for verification, tracking which law versions were used. Enable verification of whether cited laws are still current. Integrates with ChatService and GeneratorService. Contract: contracts/audit.md","status":"open","priority":2,"issue_type":"feature","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:18:34.0038166+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:18:34.0038166+07:00","labels":["component:audit","phase:audit","spec:002-connect-db","story:US5"],"dependencies":[{"issue_id":"chatbot-w4o","depends_on_id":"chatbot-m3x","type":"parent-child","created_at":"2026-02-10T11:18:34.0219819+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-w4o","depends_on_id":"chatbot-3mo","type":"blocks","created_at":"2026-02-10T11:18:34.0289852+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-wsi","title":"Update .env.example with Supabase vars","description":"Add Supabase and pipeline environment variables to .env.example","design":"Edit .env.example. Add DB_MODE, SUPABASE_URL, SUPABASE_KEY, SUPABASE_SERVICE_KEY, PIPELINE_CRAWL_INTERVAL, PIPELINE_RATE_LIMIT, PIPELINE_MAX_PAGES, EMBEDDING_MODEL, EMBEDDING_DIMENSION. See spec.md section 9.","acceptance_criteria":".env.example contains all new vars with placeholder values. Existing vars unchanged.","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-10T11:10:53.8626525+07:00","created_by":"Bao Lam","updated_at":"2026-02-10T11:34:02.4878836+07:00","closed_at":"2026-02-10T11:34:02.4878836+07:00","close_reason":"Added DB_MODE, SUPABASE_*, PIPELINE_*, EMBEDDING_* vars to .env.example","labels":["component:infra","phase:setup","spec:002-connect-db"],"dependencies":[{"issue_id":"chatbot-wsi","depends_on_id":"chatbot-4m1","type":"parent-child","created_at":"2026-02-10T11:10:53.8652232+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-xb8","title":"Implement chat service with citation extraction","description":"Implement main chat service that combines RAG and LLM with citation extraction.","design":"In services/chat.py add ChatService class with chat() method: retrieve articles, build context, call Groq LLM with system prompt + context + query, parse response to extract citations (regex for Dieu patterns), return ChatResponse with answer, citations, suggested_templates.","acceptance_criteria":"Chat returns grounded answers. Citations extracted from response. Suggestions included when relevant.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:20:14.5858961+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:20:14.5858961+07:00","labels":["component:chat","phase:us3","spec:001-planning","story:US3"],"dependencies":[{"issue_id":"chatbot-xb8","depends_on_id":"chatbot-17y","type":"parent-child","created_at":"2026-02-05T15:20:14.589618+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-z3s","title":"Configure Pino logging with correlation IDs","description":"Setup structured logging with Pino, request correlation IDs, and log levels per environment","design":"Create backend/src/lib/logger.ts. Configure Pino with JSON format, request ID middleware using AsyncLocalStorage. Set LOG_LEVEL from env (debug for dev, info for prod). Add pino-pretty for development.","acceptance_criteria":"All requests logged with correlation ID, log level configurable, JSON output in production, pretty output in dev","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:23:06.9148846+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T13:55:45.5455353+07:00","closed_at":"2026-02-05T13:55:45.5455353+07:00","close_reason":"Pino logging configured with AsyncLocalStorage-based correlation IDs. Features: correlationMiddleware adds X-Correlation-ID, requestLoggingMiddleware logs request/response, JSON output in prod, pino-pretty in dev, configurable LOG_LEVEL.","labels":["component:backend","component:observability","phase:foundational","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-z3s","depends_on_id":"chatbot-9qs","type":"parent-child","created_at":"2026-02-04T16:23:06.9199963+07:00","created_by":"Bao Lam"},{"issue_id":"chatbot-z3s","depends_on_id":"chatbot-ek0","type":"blocks","created_at":"2026-02-04T16:23:06.9235569+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-zpx","title":"Setup PostgreSQL with pgvector","description":"Configure PostgreSQL database with pgvector extension for vector similarity search","design":"Create docker-compose.yml with pgvector/pgvector:pg16 image. Initialize database with CREATE EXTENSION vector. Configure connection pooling. Document in quickstart.md.","acceptance_criteria":"Docker container starts, pgvector extension enabled, test query with vector type succeeds","status":"closed","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:22:34.8839492+07:00","created_by":"Bao Lam","updated_at":"2026-02-04T17:54:23.582991+07:00","closed_at":"2026-02-04T17:54:23.582991+07:00","close_reason":"docker-compose.yml created with pgvector/pgvector:pg16 image. Init script scripts/init-db.sql enables vector extension and verifies operations. Health check configured.","labels":["component:db","phase:foundational","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-zpx","depends_on_id":"chatbot-9qs","type":"parent-child","created_at":"2026-02-04T16:22:34.8888317+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-zu8","title":"Implement DocumentTemplate service","description":"Create service for managing document templates with CRUD operations","design":"Create backend/src/services/document/template.service.ts. Methods: create(data), findAll(filters), findById(id), update(id, data). Store required_fields and optional_fields as JSONB. Template files stored in backend/templates/{category}/.","acceptance_criteria":"Templates CRUD works, required fields schema validates, category filtering works","status":"closed","priority":2,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-04T16:26:13.7582487+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T14:06:59.8314834+07:00","closed_at":"2026-02-05T14:06:59.8314834+07:00","close_reason":"DocumentTemplateService implemented. Features: list templates (by category), findById, create, validateVariables (type checking, required/optional fields, Vietnamese error messages), generateDocument (creates record, validation), getGeneratedDocument, listUserDocuments.","labels":["component:backend","phase:us4","spec:001-planning","story:US4"],"dependencies":[{"issue_id":"chatbot-zu8","depends_on_id":"chatbot-pul","type":"parent-child","created_at":"2026-02-04T16:26:13.7641337+07:00","created_by":"Bao Lam"}]}
{"id":"chatbot-zyi","title":"Implement Pydantic domain models","description":"Create all Pydantic models for domain entities as defined in data-model.md.","design":"Create legal_chatbot/models/document.py with DocumentType, DocumentStatus, LegalDocument, Article, ArticleWithContext. Create models/chat.py with MessageRole, Citation, ChatMessage, ChatSession. Create models/template.py with TemplateType, ContractField, ContractTemplate, GeneratedContract.","acceptance_criteria":"All models import correctly. Pydantic validation works. Enums defined.","status":"open","priority":1,"issue_type":"task","owner":"tungseo201@gmail.com","created_at":"2026-02-05T15:17:29.5309675+07:00","created_by":"Bao Lam","updated_at":"2026-02-05T15:17:29.5309675+07:00","labels":["component:models","phase:foundational","spec:001-planning"],"dependencies":[{"issue_id":"chatbot-zyi","depends_on_id":"chatbot-t2s","type":"parent-child","created_at":"2026-02-05T15:17:29.5359059+07:00","created_by":"Bao Lam"}]}
